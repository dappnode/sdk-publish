{"version":3,"sources":["utils/executePublishTx.ts","img/metamask-white.png","components/Title.tsx","components/SubTitle.tsx","utils/css.ts","components/Card.tsx","components/ErrorView.tsx","components/LoadingView.tsx","utils/notNullish.ts","utils/apmRepoIsAllowed.ts","utils/getLatestVersion.ts","utils/fetchManifest.ts","params.ts","utils/isValidBump.ts","utils/isIpfsHash.ts","utils/isValidEns.ts","utils/newTabProps.ts","settings.ts","utils/signRelease.ts","utils/fetchRelease.ts","App.tsx","utils/urlQuery.ts","index.tsx","utils/resolveDnpName.ts"],"names":["executePublishTx","provider","a","dnpName","version","manifestHash","developerAddress","Error","signer","getSigner","resolveDnpName","registryAddress","repoAddress","contentURI","Buffer","from","toString","contractAddress","shortName","split","repo","ethers","Contract","repoContract","abi","populateTransaction","newVersion","unsignedTx","registry","registryContract","newRepoWithVersion","sendTransaction","txResponse","hash","module","exports","Title","title","subtitle","children","className","SubTitle","joinCssClass","args","reduce","classNames","arg","push","Object","entries","key","join","shadowStyle","boxShadow","Card","shadow","spacing","divider","noscroll","props","style","overflowX","Body","ErrorView","error","message","detail","stack","JSON","stringify","parseError","LoadingView","steps","useState","index","setIndex","useEffect","interval","setInterval","i","clearInterval","length","ProgressBar","animated","now","notNullish","value","undefined","apmRepoIsAllowed","userAddress","canPerform","getLatest","res","semanticVersion","IPFS_GATEWAY","fetch","then","json","releaseTypes","isValidBump","prevVersion","nextVersion","type","semver","inc","parseIpfsPath","includes","isIpfsHash","replace","isIPFS","cid","isMultihash","isValidEns","ensDomain","newTabProps","rel","target","parseIpfsApiUrls","ipfsApiUrls","trim","map","row","filter","signRelease","releaseHash","ipfsArr","ipfsApiUrl","create","url","ipfs","ipfsExtras","releaseCID","CID","parse","dag","get","releaseRootDag","dagGetToFilenames","find","filename","releaseFiles","dagGetToFiles","signedData","serializeIpfsDirectory","cidOpts","base","providers","Web3Provider","window","ethereum","signMessage","flatSig","signature","signature_protocol","signatureJson","add","signatureIpfsEntry","ipfsExtra","Links","Hash","Name","Tsize","size","sortBy","console","log","dagProps","format","hashAlg","put","newReleaseCid","newReleaseRootDag","newFilesStr","sort","expectedFilesStr","file","name","toV0","files","opts","b","localeCompare","cidStr","base58btc","base32","base64","base64url","cidToString","toV1","getCidAtVersion","content","link","ok","statusText","text","fetchManifestMem","memoizee","promise","resolveDnpNameMem","getLatestVersionMem","getInputClass","success","App","showSettings","setShowSettings","localStorage","getItem","readIpfsApiUrls","setIpfsApiUrls","setDnpName","setVersion","setDeveloperAddress","setReleaseHash","manifest","setManifest","isSigned","setIsSigned","repoAddresses","setRepoAddresses","latestVersion","setLatestVersion","providerReq","setProviderReq","signReq","setSignReq","publishReqStatus","setPublishReqStatus","result","setItem","writeIpfsApiUrls","urlParams","params","startsWith","slice","obj","pair","decodeURIComponent","parseUrlQuery","location","search","r","v","d","h","on","accounts","onNewManifestHash","useMemo","debounce","catch","e","fetchReleaseSignature","onNewDnpName","loading","enable","web3","currentProvider","newReleaseHash","getNetwork","network","String","chainId","listAccounts","txHash","fields","id","placeholder","help","onValueChange","validations","isValid","utils","isAddress","valid","role","backgroundColor","href","field","errors","Fragment","onChange","item","disabled","onClick","src","metamaskIcon","alt","ReactDOM","render","StrictMode","document","getElementById","registryName","parseRegistryName","Promise","all","resolveEns","ensName","resolveName","repoName"],"mappings":"gNAKO,SAAeA,EAAtB,oC,4CAAO,aAYLC,GAZK,2CAAAC,EAAA,yDAEHC,EAFG,EAEHA,QACAC,EAHG,EAGHA,QACAC,EAJG,EAIHA,aACAC,EALG,EAKHA,iBASGH,EAdA,sBAceI,MAAM,2BAdrB,UAeAH,EAfA,sBAeeG,MAAM,2BAfrB,UAgBAF,EAhBA,sBAgBoBE,MAAM,gCAhB1B,cAkBCC,EAASP,EAASQ,YAlBnB,UAmB0CC,YAC7CP,EACAF,GArBG,oBAmBGU,EAnBH,EAmBGA,gBAAiBC,EAnBpB,EAmBoBA,YAMnBC,EAAa,KAAOC,EAAOC,KAAKV,EAAc,QAAQW,SAAS,OAE/DC,EAAkB,6CAClBC,EAAYf,EAAQgB,MAAM,KAAK,IAIjCP,EAhCC,wBAsCGQ,EAAO,IAAIC,SAAOC,SAASV,EAAaW,EAAaC,IAAKhB,GAtC7D,UAuCgBY,EAAKK,oBAAoBC,WAC1CtB,EAAQe,MAAM,KACdF,EACAJ,GA1CC,QAuCHc,EAvCG,kCAkDErB,EAlDF,uBAmDKC,MAAM,kDAnDX,WAqDEI,EArDF,uBAqDyBJ,MAAM,yBAAD,OAA0BJ,IArDxD,eA8DGyB,EAAW,IAAIP,SAAOC,SAC1BX,EACAkB,EAAiBL,IACjBhB,GAjEC,UAmEgBoB,EAASH,oBAAoBK,mBAC9CZ,EACAZ,EACAF,EAAQe,MAAM,KACdF,EACAJ,GAxEC,QAmEHc,EAnEG,gCA4EoBnB,EAAOuB,gBAAgBJ,GA5E3C,eA4ECK,EA5ED,yBA6EEA,EAAWC,MA7Eb,6C,ssICLPC,EAAOC,QAAU,ksF,myHCOJC,EAA6C,SAAC,GAIpD,IAHLC,EAGI,EAHJA,MACAC,EAEI,EAFJA,SACAC,EACI,EADJA,SAEA,OAAIA,EAAiB,yBAAKC,UAAU,iBAAiBD,GACjDD,EAEA,yBAAKE,UAAU,iBACb,0BAAMA,UAAU,aAAaH,EAA7B,KACCC,GAGA,yBAAKE,UAAU,iBAAiBH,IClB5BI,EAA4D,SAAC,GAAD,IACvEF,EADuE,EACvEA,SACAC,EAFuE,EAEvEA,UAFuE,OAGnE,yBAAKA,UAAS,2BAAsBA,GAAa,KAAOD,I,0BCKvD,SAASG,IAA2C,IAAD,uBAA1BC,EAA0B,yBAA1BA,EAA0B,gBACxD,OAAOA,EACJC,QAAO,SAACC,EAAYC,GAEnB,GADmB,kBAARA,GAAkBD,EAAWE,KAAKD,GAC1B,kBAARA,EACT,cAAyBE,OAAOC,QAAQH,GAAO,IAA/C,0CAAYI,EAAZ,WACWL,EAAWE,KAAKG,GAC7B,OAAOL,IACN,IACFM,KAAK,KCfV,IAAMC,EAAc,CAAEC,UAAW,sCAYpBC,EAET,SAAC,GAAD,IACFf,EADE,EACFA,SADE,IAEFC,iBAFE,MAEU,GAFV,EAGFe,EAHE,EAGFA,OACAC,EAJE,EAIFA,QACAC,EALE,EAKFA,QACAC,EANE,EAMFA,SACGC,EAPD,uFASF,kBAAC,IAAD,CACEC,MAAK,aACHC,UAAWH,EAAW,UAAY,QAC9BH,EAASH,EAAc,KAG7B,kBAAC,IAAcU,KAAf,eACEtB,UAAWE,EAAa,aACtBc,UACAC,UACAC,YACClB,EAAYA,KAEXmB,GAEHpB,K,OC9BA,SAASwB,EAAT,GAA0D,IAAD,EAThE,SACEC,GAEA,OAAIA,aAAiBzD,OAA2B,kBAAVyD,GAAsBA,EAAMC,QACzD,CAAEA,QAASD,EAAMC,QAASC,OAAQF,EAAMG,OAC5B,kBAAVH,EAA2B,CAAEC,QAASD,GAC1C,CAAEC,QAASG,KAAKC,UAAUL,GAAQE,OAAQ,IAIrBI,CADkC,EAApCN,OAClBC,EADsD,EACtDA,QAASC,EAD6C,EAC7CA,OAEjB,OACE,yBAAK1B,UAAU,aACb,iCACE,iCAAUyB,EAAQ9C,MAAM,MAAM,IAC9B,6BAAM+C,K,aChBP,SAASK,EAAT,GAAuD,IAAhCC,EAA+B,EAA/BA,MAA+B,EACjCC,mBAAS,GADwB,mBACpDC,EADoD,KAC7CC,EAD6C,KAO3D,OALAC,qBAAU,WACR,IAAMC,EAAWC,aAAY,kBAAMH,GAAS,SAACI,GAAD,OAAOA,EAAI,OAAI,KAC3D,OAAO,kBAAMC,cAAcH,MAC1B,IAGD,yBAAKrC,UAAU,eACZgC,GACC,yBAAKhC,UAAU,oBACZgC,EAAME,IAAUF,EAAMA,EAAMS,OAAS,GADxC,OAIF,kBAACC,EAAA,EAAD,CAAaC,UAAQ,EAACC,IAAK,OCT1B,SAASC,EACdC,GAEA,OAAiB,OAAVA,QAA4BC,IAAVD,E,qBCRpB,SAAeE,EAAtB,sC,4CAAO,WACL5E,EACA6E,EACAxF,GAHK,eAAAC,EAAA,6DAKCkB,EAAO,IAAIC,SAAOC,SAASV,EAAaW,EAAaC,IAAKvB,GAL3D,kBAQUmB,EAAKsE,WAChBD,EACA,qEACA,IAXC,8EAeH,KAAExB,QAAF,mCAAwCwB,EAAxC,cAAyD,KAAExB,SAfxD,+D,kECAA,WACLrD,EACAX,GAFK,iBAAAC,EAAA,6DAICkB,EAAO,IAAIC,SAAOC,SAASV,EAAaW,EAAaC,IAAKvB,GAJ3D,kBAOemB,EAAKuE,YAPpB,cAOGC,EAPH,yBAQIA,EAAIC,gBAAgB1C,KAAK,MAR7B,sCAWH,KAAEc,QAAF,0CAA+CrD,EAA/C,aAA+D,KAAEqD,SAX9D,+D,kECAA,WACLhC,EACA6D,GAFK,SAAA5F,EAAA,+EAKU6F,MAAM,GAAD,OAAID,GAAJ,OAAmB7D,EAAnB,YCAU,0BDAqC+D,MAC/D,SAACJ,GAAD,OAASA,EAAIK,UANZ,yFASUF,MAAM,GAAD,OAAID,GAAJ,OAAmB7D,IAAQ+D,MAAK,SAACJ,GAAD,OAASA,EAAIK,UAT5D,mG,0CEDDC,EAAqC,CAAC,QAAS,QAAS,SAEvD,SAASC,EAAYC,EAAqBC,GAA+B,IAAD,gBAC1DH,GAD0D,IAC7E,2BAAiC,CAAC,IAAvBI,EAAsB,QAC/B,GAAIC,IAAOC,IAAIJ,EAAaE,KAAUD,EAAa,OAAO,GAFiB,8BAI7E,OAAO,E,sBCDF,SAASI,EAAcxE,GAI5B,OAHIA,EAAKyE,SAAS,WAChBzE,EAAOA,EAAKd,MAAM,SAAS,IAEtBc,EAYF,SAAS0E,EAAW1E,GACzB,SAAKA,GAAwB,kBAATA,MAEpBA,EAAOwE,EAAcxE,IAChB2E,QAAQ,IAAK,IAxBpB,SAAqB3E,GACnB,OAAO4E,IAAOC,IAAI7E,GAyBX8E,CAAY9E,IC7Bd,SAAS+E,EAAWC,GACzB,OAAOA,EAAUP,SAAS,KCQrB,IAAMQ,EAAc,CAAEC,IAAK,sBAAuBC,OAAQ,UCI1D,SAASC,EAAiBC,GAC/B,OAAOA,EACJC,OACApG,MAAM,MACNqG,KAAI,SAACC,GAAD,OAASA,EAAIF,UACjBG,QAAO,SAACD,GAAD,OAASA,K,+FCTd,SAAeE,GAAtB,qC,8CAAO,WACLC,EACAN,GAFK,iEAAApH,EAAA,2DAIDoH,EAAYrC,OAAS,GAJpB,sBAKG1E,MAAM,wBALT,cAQCsH,EAAUP,EAAYE,KAAI,SAACM,GAAD,OAAgBC,iBAAO,CAAEC,IAAKF,OARzD,cASyBD,GAAvBI,EATF,KASWC,EATX,WAYCC,EAAaC,MAAIC,MAAM5B,EAAcmB,IAZtC,SAc0DK,EAAKK,IAAIC,IACtEJ,GAfG,UAcCK,EAdD,QAkBoBC,GAAkBD,GACtBE,MAAK,SAACC,GAAD,MNrBK,mBMqBSA,KAnBnC,uBAoBGpI,MAAM,6BApBT,eAuBCqI,EAAeC,GAAcL,GAE7BM,EAAaC,GAAuBH,EADpCI,EAAmC,CAAE5I,QAAS,EAAG6I,KAAM,cAGvDhJ,EAAW,IAAIoB,SAAO6H,UAAUC,aAAaC,OAAOC,UAKpD7I,EAASP,EAASQ,YAhCnB,UAkCiBD,EAAO8I,YAAYR,GAlCpC,eAkCCS,EAlCD,OAoCCC,EAA8B,CAClCpJ,QAAS,EACT0G,IAAKkC,EACLS,mBAAoB,YACpBD,UAAWD,GAGPG,EAAgBtF,KAAKC,UAAUmF,EAAW,KAAM,GA3CjD,UA4C4BvB,EAAK0B,IAAID,GA5CrC,QA4CCE,EA5CD,qBA8CmB1B,GA9CnB,kEA8CM2B,EA9CN,kBA8CqCA,EAAUF,IAAID,GA9CnD,wJAkDLlB,EAAelD,MAAMwE,MAAM/G,KAAK,CAC9BgH,KAAMH,EAAmB9C,IACzBkD,KNtD6B,iBMuD7BC,MAAOL,EAAmBM,OAI5B1B,EAAelD,MAAMwE,MAAQK,KAAO3B,EAAelD,MAAMwE,MAAO,CAC9D,OACA,UAGFM,QAAQC,IAAI7B,GAEN8B,EAAW,CAAEC,OAAQ,SAAUC,QAAS,YAhEzC,UAiEuBvC,EAAKK,IAAImC,IAAIjC,EAAelD,MAAOgF,GAjE1D,QAiECI,EAjED,qBAmEmBxC,GAnEnB,kEAmEM2B,EAnEN,kBAoEGA,EAAUvB,IAAImC,IAAIjC,EAAelD,MAAOgF,GApE3C,kKAuE2BrC,EAAKK,IAAIC,IAAImC,GAvExC,WAuECC,EAvED,OAwECC,EAAcxG,KAAKC,UACvBoE,GAAkBkC,GAAmBE,QAEjCC,EAAmB1G,KAAKC,UAC5B,sBAAIuE,EAAapB,KAAI,SAACuD,GAAD,OAAUA,EAAKC,SAApC,CN9E6B,mBM8EiCH,QAE5DD,IAAgBE,EA9Ef,uBA+EGvK,MAAM,+BAAD,OAAgCqK,IA/ExC,iCAkFEF,EAAcO,OAAOjK,YAlFvB,gF,sBAwHP,SAAS+H,GACPmC,EACAC,GAEA,OACED,EACGxD,QAAO,SAACqD,GAAD,MNhImB,mBMgITA,EAAKC,QAEtBH,MAAK,SAAC3K,EAAGkL,GAAJ,OAAUlL,EAAE8K,KAAKK,cAAcD,EAAEJ,SAEtCxD,KAAI,SAACuD,GACJ,IAAMO,EAuCd,SAAqBxE,EAAUmC,GAC7B,OAAQA,GACN,IAAK,YACH,OAAOnC,EAAI9F,SAASuK,aACtB,IAAK,SACH,OAAOzE,EAAI9F,SAASwK,UACtB,IAAK,SACH,OAAO1E,EAAI9F,SAASyK,WACtB,IAAK,YACH,OAAO3E,EAAI9F,SAAS0K,cACtB,QACE,MAAMnL,MAAM,oBAAD,OAAqB0I,KAlDf0C,CA4BvB,SAAyB7E,EAAU1G,GACjC,OAAQA,GACN,KAAK,EACH,OAAO0G,EAAImE,OACb,KAAK,EACH,OAAOnE,EAAI8E,OACb,QACE,MAAMrL,MAAM,uBAAD,OAAwBH,KAlC/ByL,CAAgBd,EAAKjE,IAAKqE,EAAK/K,SAC/B+K,EAAKlC,MAEP,MAAM,GAAN,OAAU8B,EAAKC,KAAf,YAAuBM,MAExBnI,KAAK,MAsDZ,SAAS0F,GACPiD,GAEA,OAAOA,EAAQxG,MAAMwE,MAAMtC,KAAI,SAACuE,GAAD,MAAW,CACxCjF,IAAKsB,MAAIC,MAAM5B,EAAcsF,EAAKhC,KAAK/I,aACvCgK,KAAMe,EAAK/B,SAIf,SAASvB,GACPqD,GAEA,OAAOA,EAAQxG,MAAMwE,MAAMtC,KAAI,SAACuE,GAAD,OAAUA,EAAK/B,Q,8CCjNzC,WACL/H,EACA6D,GAFK,eAAA5F,EAAA,6DAIL+B,EAAOwE,EAAcxE,GAJhB,SAMa8D,MAAM,GAAD,OAAID,EAAJ,iBAAyB7D,EAAzB,YPFQ,mBOJ1B,WAMC2D,EAND,QAQIoG,GARJ,sBASGzL,MAAM,SAAD,OAAUqF,EAAIqG,aATtB,uBAYQrG,EAAIsG,OAZZ,oF,sBCgCP,IAAMC,GAAmBC,KThClB,SAAP,sCSgCiD,CAAEC,SAAS,IACtDC,GAAoBF,IAAS1L,IAAgB,CAAE2L,SAAS,IACxDE,GAAsBH,KVlCrB,SAAP,sCUkCuD,CAAEC,SAAS,IAK5DG,GAAgB,SAAC,GAAD,IACpBC,EADoB,EACpBA,QADoB,SAEpBzI,MAIa,aAAeyI,EAAU,WAAa,IAE9C,SAASC,KAAM,MAEoBjI,oBAAS,GAF7B,mBAEbkI,EAFa,KAECC,EAFD,OAGkBnI,mBHnDjC,WAAoC,IAAD,EACxC,iBAAOoI,aAAaC,QAHC,wBAGrB,QAA+C,GGkDAC,IAH3B,mBAGbzF,EAHa,KAGA0F,EAHA,OAKUvI,mBAAS,IALnB,mBAKbtE,EALa,KAKJ8M,EALI,OAMUxI,mBAAS,IANnB,mBAMbrE,EANa,KAMJ8M,EANI,OAO4BzI,mBAAS,IAPrC,mBAObnE,EAPa,KAOK6M,EAPL,OAQkB1I,mBAAS,IAR3B,mBAQbmD,EARa,KAQAwF,EARA,OASY3I,qBATZ,mBASb4I,EATa,KASHC,EATG,OAUY7I,mBAAyB,MAVrC,mBAUb8I,EAVa,KAUHC,GAVG,QAWsB/I,qBAXtB,qBAWbgJ,GAXa,MAWEC,GAXF,SAYsBjJ,qBAZtB,qBAYbkJ,GAZa,MAYEC,GAZF,SAakBnJ,mBAEpC,IAfkB,qBAaboJ,GAba,MAaAC,GAbA,SAgBUrJ,mBAAgC,IAhB1C,qBAgBbsJ,GAhBa,MAgBJC,GAhBI,SAiB4BvJ,mBAE9C,IAnBkB,qBAiBbwJ,GAjBa,MAiBKC,GAjBL,MAsBdjO,GAAW4N,GAAYM,OAG7BvJ,qBAAU,kBHrEL,SAA0B0C,GAC/BuF,aAAauB,QAPQ,gBAOgB9G,GGoErB+G,CAAiB/G,KAAc,CAACA,IAMhD1C,qBAAU,WACR,IAAM0J,ECzEmB,WAAkB,IAAjBC,EAAgB,uDAAP,GAErC,OADIA,EAAOC,WAAW,OAAMD,EAASA,EAAOE,MAAM,IAC3CF,EAAOpN,MAAM,KAAKyB,QAAO,SAAC8L,EAAgCC,GAAU,IAAD,EACnDA,EAAKxN,MAAM,KADwC,mBACjE+B,EADiE,KAC5DoC,EAD4D,KAGxE,OADAoJ,EAAIxL,GAAO0L,mBAAmBtJ,GACvBoJ,IACN,IDmEiBG,CAAczF,OAAO0F,SAASC,QAChD3E,QAAQC,IAAI,aAAciE,GACtBA,EAAUU,GAAG/B,EAAWqB,EAAUU,GAClCV,EAAUW,GAAG/B,EAAWoB,EAAUW,GAClCX,EAAUY,GAAG/B,EAAoBmB,EAAUY,GAC3CZ,EAAUa,GAAG/B,EAAekB,EAAUa,KACzC,IAEHvK,qBAAU,WAIR,IAAMyE,EAAWD,OAAOC,SACpBA,GACFA,EAAS+F,GAAG,mBAAmB,SAACC,GAC9BjF,QAAQC,IAAI,mBAAoBgF,EAAS,SAE5C,IAIH,IAAMC,GAAoBC,mBACxB,kBACEC,oBAAS,SAACvN,GACRkK,GAAiBlK,ERzGG,mBQ0GjB+D,MAAK,SAACqH,GAAD,OAAcC,EAAY,2BAAKD,GAAN,IAAgBpL,aAC9CwN,OAAM,SAACC,GAAD,OAAOtF,QAAQpG,MAAR,kCAAyC/B,GAAQyN,MDzGlE,SAAP,qCC2GQC,CAAsB1N,ER7GF,mBQ8GjB+D,MAAK,kBAAMwH,IAAY,MACvBiC,OAAM,SAACC,GACNtF,QAAQpG,MAAR,iCAAwC/B,GAAQyN,GAChDlC,IAAY,QAEf,OACL,IAEIoC,GAAeL,mBACnB,kBACEC,oBAAS,SAACrP,EAAiBF,GACzBmK,QAAQC,IAAI,aAAclK,GAC1BmM,GAAkBnM,EAASF,GACxB+F,KAAK0H,IACL+B,OAAM,SAACC,GAAD,OAAOtF,QAAQpG,MAAR,kCAAyC7D,GAAWuP,MACpEnD,GAAoBpM,EAASF,GAC1B+F,KAAK4H,IACL6B,OAAM,SAACC,GAAD,OAAOtF,QAAQpG,MAAR,+BAAsC7D,GAAWuP,QAChE,OACL,IAhFkB,8CA4FpB,sBAAAxP,EAAA,kEAEI4N,GAAe,CAAE+B,SAAS,KAEtBzG,OAAOC,SAJf,gCAMYD,OAAOC,SAASyG,SAN5B,OAQMhC,GAAe,CACbK,OAAQ,IAAI9M,SAAO6H,UAAUC,aAAaC,OAAOC,YATzD,2BAaaD,OAAO2G,KAbpB,iBAcMjC,GAAe,CACbK,OAAQ,IAAI9M,SAAO6H,UAAUC,aAC3BC,OAAO2G,KAAKC,mBAhBtB,8BAsBYzP,MAAM,2DAtBlB,0DAyBI6J,QAAQpG,MAAR,MACA8J,GAAe,CAAE9J,MAAM,EAAD,KA1B1B,2DA5FoB,oEA0HpB,4BAAA9D,EAAA,sEAEI8N,GAAW,CAAE6B,SAAS,IAF1B,SAIiClI,GAC3BC,EACAP,EAAiBC,IANvB,OAIU2I,EAJV,OAQIjC,GAAW,CAAEG,OAAQ8B,IACrB7C,EAAe,SAAD,OAAU6C,IAT5B,gDAWI7F,QAAQpG,MAAR,MACAgK,GAAW,CAAEhK,MAAM,EAAD,KAZtB,0DA1HoB,oEA0IpB,sCAAA9D,EAAA,kEAESC,EAFT,sBAEwBI,MAAM,0BAF9B,UAGSH,EAHT,sBAGwBG,MAAM,0BAH9B,UAISqH,EAJT,sBAI4BrH,MAAM,+BAJlC,UAMI2N,GAAoB,CAAE2B,SAAS,IAE1B5P,GART,uBAQyBM,MAAM,kCAR/B,yBAS0BN,GAASiQ,aATnC,aASUC,EATV,SAW+C,MAA5BC,OAAOD,EAAQE,SAXlC,uBAYY9P,MAAM,sDAZlB,yBAc2BN,GAASqQ,eAdpC,WAcUjB,EAdV,SAeU5J,EAAc4J,EAAS,IAfjC,kCAiBoC/C,GAAkBnM,EAASF,IAjB/D,sBAiBcW,EAjBd,EAiBcA,aAjBd,kCAmBgC4E,EACtB5E,EACA6E,EACAxF,IAtBV,yCAyBgBM,MAAM,oBAAD,OACWkF,EADX,+BAzBrB,yBA+ByBzF,YACnB,CAAEG,UAASC,UAASC,aAAcuH,EAAatH,oBAC/CL,IAjCN,QA+BUsQ,EA/BV,OAmCIrC,GAAoB,CAAEC,OAAQoC,IAnClC,kDAqCInG,QAAQpG,MAAR,MACAkK,GAAoB,CAAElK,MAAM,EAAD,KAtC/B,2DA1IoB,sBAmFpBY,qBAAU,WACJgD,GAAa0H,GAAkB1H,KAClC,CAACA,EAAa0H,KAEjB1K,qBAAU,WACJzE,GAAW6G,EAAW7G,IAAYF,IACpC2P,GAAazP,EAASF,MACvB,CAACE,EAASF,GAAU2P,KA6FvB,IAAMY,GAAsB,CAC1B,CACEC,GAAI,UACJzF,KAAM,wBACN0F,YAAa,gBACbC,KAAM,+EACNrL,MAAOnF,EACPyQ,cAAe3D,EACf4D,YAAa,CACX1Q,EACI6G,EAAW7G,GACT,CAAE2Q,SAAS,EAAM7M,QAAS,oBAC1B,CAAE6M,SAAS,EAAO7M,QAAS,sBAC7B,KACJ9D,GAAWsN,GACPA,GAAc9M,gBACZ8M,GAAc7M,YACZ,CACEkQ,SAAS,EACT7M,QAAQ,6BAAD,OAA+BwJ,GAAc7M,cAEtD,CACEkQ,SAAS,EACT7M,QAAQ,+BAAD,OAAiC9D,IAE5C,CACE2Q,SAAS,EACT7M,QAAQ,+BAAD,OAAiC9D,IAE5C,OAGR,CACEsQ,GAAI,mBACJzF,KAAM,oBACN0F,YAAa,mBACbC,KAAM,2DACNrL,MAAOhF,EACPsQ,cAAezD,EACf0D,YAAa,CACXvQ,EACIe,SAAO0P,MAAMC,UAAU1Q,GACrB,CAAEwQ,SAAS,EAAM7M,QAAS,iBAC1B,CAAE6M,SAAS,EAAO7M,QAAS,oCAC7B,OAGR,CACEwM,GAAI,UACJzF,KAAM,eACN0F,YAAa,mBACbC,KAAM,qDACNrL,MAAOlF,EACPwQ,cAAe1D,EACf2D,YAAa,CACXzQ,EACImG,IAAO0K,MAAM7Q,GACX,CAAE0Q,SAAS,EAAM7M,QAAS,gBAC1B,CAAE6M,SAAS,EAAO7M,QAAS,kBAC7B,KACJ7D,GAAWuN,GACPxH,EAAYwH,GAAevN,GACzB,CAAE0Q,SAAS,EAAM7M,QAAQ,mBAAD,OAAqB0J,KAC7C,CAAEmD,SAAS,EAAO7M,QAAS,oCAC7B,OAGR,CACEwM,GAAI,kBACJzF,KAAM,eACN0F,YAAa,iBACbC,KAAM,+HACNrL,MAAOsC,EACPgJ,cAAexD,EACfyD,YAAa,CACXjJ,EACIjB,EAAWiB,GACT,CAAEkJ,SAAS,EAAM7M,QAAS,mBAC1B,CAAE6M,SAAS,EAAO7M,QAAS,qBAC7B,KACJoJ,GACAzF,GACAA,IAAgByF,EAASpL,MACzBoL,EAASrC,MACTqC,EAASjN,QACLiN,EAASrC,OAAS7K,GAAWkN,EAASjN,UAAYA,EAChD,CAAE0Q,SAAS,EAAM7M,QAAS,kCAC1B,CACE6M,SAAS,EACT7M,QAAQ,sDAAD,OAAwDoJ,EAASrC,KAAjE,cAA2EqC,EAASjN,UAE/F,MACS,IAAbmN,EACI,CAAEuD,SAAS,EAAM7M,QAAS,sBACb,IAAbsJ,EACA,CAAEuD,SAAS,EAAO7M,QAAS,sBAC3B,QAKV,OACE,yBAAKzB,UAAU,OACb,kBAAC,EAAD,CAAOH,MAAM,MAAMC,SAAS,YAC5B,yBAAKE,UAAU,mBACb,gLAKE4G,OAAO0F,SAASC,QAChB,yBACEvM,UAAU,wBACV0O,KAAK,QACLtN,MAAO,CAAEuN,gBAAiB,YAH5B,4FAM8B,IAC5B,qCAAGC,KR1VgB,2CQ0VWlK,GAC5B,0DAKR,kBAAC,EAAD,4BACA,kBAAC,EAAD,KACE,yBAAK1E,UAAU,gBACZgO,GAAOhJ,KAAI,SAAC6J,GACX,IAAMR,GAAeQ,EAAMR,aAAe,IAAInJ,OAAOrC,GAC/CoH,EAAUoE,EAAYnJ,QAAO,SAACuH,GAAD,OAAOA,GAAKA,EAAE6B,WAC3CQ,EAAST,EAAYnJ,QAAO,SAACuH,GAAD,OAAOA,IAAMA,EAAE6B,WACjD,OACE,kBAAC,IAAMS,SAAP,CAAgBrO,IAAKmO,EAAMrG,MACzB,yBAAKxI,UAAU,cAAc6O,EAAMrG,MACnC,6BACE,2BACExI,UAAS,uBAAkBgK,GAAc,CACvCxI,MAAOsN,EAAOrM,OAAS,EACvBwH,QAASA,EAAQxH,OAAS,KAE5ByL,YAAaW,EAAMX,YACnBpL,MAAO+L,EAAM/L,MACbkM,SAAU,SAAC9B,GAAD,OAAO2B,EAAMT,cAAclB,EAAEtI,OAAO9B,UAE/CmH,EAAQjF,KAAI,SAACiK,EAAM1M,GAAP,OACX,yBAAK7B,IAAK6B,EAAGvC,UAAU,kBACrB,6BAAMiP,EAAKxN,aAGdqN,EAAO9J,KAAI,SAACiK,EAAM1M,GAAP,OACV,yBAAK7B,IAAK6B,EAAGvC,UAAU,oBACrB,6BAAMiP,EAAKxN,aAGf,2BAAOzB,UAAU,6BACd6O,EAAMV,WAQjB,8BACA,yBAAKnO,UAAU,kBAEb,yBAAKA,UAAU,kBACZvC,GACC,4BACEuC,UAAU,mBACVkP,SAAUzD,GAAiB4B,QAC3B8B,QAlWI,6CA+VN,WAQA,4BACEnP,UAAU,mBACVkP,SAAU7D,GAAYgC,QACtB8B,QA1WI,6CA4WJ,yBAAKC,IAAKC,IAAcC,IAAI,GAAGtP,UAAU,iBAAkB,IAL7D,uBASDqL,GAAYM,QACX,4BACE3L,UAAU,mBACVkP,SAAU3D,GAAQ8B,UAAwB,IAAbtC,EAC7BoE,QApXI,6CAiXN,iBAUH9D,GAAY7J,OAAS,kBAACD,EAAD,CAAWC,MAAO6J,GAAY7J,QACnD6J,GAAYgC,SACX,kBAACtL,EAAD,CAAaC,MAAO,CAAC,4BAEtBuJ,GAAQ/J,OAAS,kBAACD,EAAD,CAAWC,MAAO+J,GAAQ/J,QAC3C+J,GAAQ8B,SAAW,kBAACtL,EAAD,CAAaC,MAAO,CAAC,qBACxCyJ,GAAiBjK,OAChB,kBAACD,EAAD,CAAWC,MAAOiK,GAAiBjK,QAEpCiK,GAAiB4B,SAChB,kBAACtL,EAAD,CAAaC,MAAO,CAAC,oCAEtByJ,GAAiBE,QAChB,yBAAK3L,UAAU,oBAAf,mCACmCyL,GAAiBE,WAO3DxB,EACC,oCACE,kBAAC,EAAD,iBACA,kBAAC,EAAD,KACE,yBAAKnK,UAAU,cAAf,iBACA,uBAAGA,UAAU,cAAb,kFAIA,8BACEA,UAAW,eACXkO,YAAY,iEACZpL,MAAOgC,EACPkK,SAAU,SAAC9B,GAAD,OAAO1C,EAAe0C,EAAEtI,OAAO9B,YAK/C,yBAAK9C,UAAU,sBACb,0BACEA,UAAU,2BACVmP,QAAS,kBAAM/E,GAAgB,KAFjC,mB,0CE3cVmF,IAASC,OACP,kBAAC,IAAMC,WAAP,KACE,kBAACvF,GAAD,OAEFwF,SAASC,eAAe,U,sGCXnB,SAAezR,EAAtB,oC,4CAAO,WACLP,EACAF,GAFK,uBAAAC,EAAA,6DAICkS,EAAeC,EAAkBlS,GAJlC,SAKwCmS,QAAQC,IAAI,CACvDC,EAAWJ,EAAcnS,GACzBuS,EAAWrS,EAASF,KAPjB,0CAKEU,EALF,KAKmBC,EALnB,uBASE,CAAED,kBAAiBC,gBATrB,4C,+BAoBQ4R,E,gFAAf,WACEC,EACAxS,GAFF,SAAAC,EAAA,+EAKiBD,EAASyS,YAAYD,GALtC,4EAOQ,KAAExO,QAAQyC,SAAS,aAP3B,0CAOgD,MAPhD,6E,sBAYA,SAAS2L,EAAkBM,GACzB,OAAOA,EAASxR,MAAM,KAAKsN,MAAM,GAAGtL,KAAK,Q","file":"static/js/main.989d7eaf.chunk.js","sourcesContent":["import { ethers } from \"ethers\";\nimport registryContract from \"contracts/registry.json\";\nimport repoContract from \"contracts/repository.json\";\nimport { resolveDnpName } from \"./resolveDnpName\";\n\nexport async function executePublishTx(\n  {\n    dnpName,\n    version,\n    manifestHash,\n    developerAddress,\n  }: {\n    dnpName: string;\n    version: string;\n    manifestHash: string;\n    developerAddress?: string;\n  },\n  provider: ethers.providers.Web3Provider\n) {\n  if (!dnpName) throw Error(\"dnpName must be defined\");\n  if (!version) throw Error(\"version must be defined\");\n  if (!manifestHash) throw Error(\"manifestHash must be defined\");\n\n  const signer = provider.getSigner();\n  const { registryAddress, repoAddress } = await resolveDnpName(\n    dnpName,\n    provider\n  );\n\n  // Compute tx data\n  const contentURI = \"0x\" + Buffer.from(manifestHash, \"utf8\").toString(\"hex\");\n  // @param _contractAddress address for smart contract logic for version (if set to 0, it uses last versions' contractAddress)\n  const contractAddress = \"0x0000000000000000000000000000000000000000\";\n  const shortName = dnpName.split(\".\")[0];\n\n  let unsignedTx: ethers.PopulatedTransaction;\n  // If repository exists, push new version to it\n  if (repoAddress) {\n    // newVersion(\n    //     uint16[3] _newSemanticVersion,\n    //     address _contractAddress,\n    //     bytes _contentURI\n    // )\n    const repo = new ethers.Contract(repoAddress, repoContract.abi, signer);\n    unsignedTx = await repo.populateTransaction.newVersion(\n      version.split(\".\"), // uint16[3] _newSemanticVersion\n      contractAddress, // address _contractAddress\n      contentURI // bytes _contentURI\n    );\n  }\n  // If repo does not exist, create a new repo and push version\n  else {\n    // A developer address can be provided by the option developerAddress.\n    // If it is not provided a prompt will ask for it\n\n    if (!developerAddress)\n      throw Error(\"developerAddress must be defined for new repos\");\n\n    if (!registryAddress) throw Error(`No registry found for ${dnpName}`);\n\n    // newRepoWithVersion(\n    //     string _name,\n    //     address _dev,\n    //     uint16[3] _initialSemanticVersion,\n    //     address _contractAddress,\n    //     bytes _contentURI\n    // )\n    const registry = new ethers.Contract(\n      registryAddress,\n      registryContract.abi,\n      signer\n    );\n    unsignedTx = await registry.populateTransaction.newRepoWithVersion(\n      shortName, // string _name\n      developerAddress, // address _dev\n      version.split(\".\"), // uint16[3] _initialSemanticVersion\n      contractAddress, // address _contractAddress\n      contentURI // bytes _contentURI\n    );\n  }\n\n  const txResponse = await signer.sendTransaction(unsignedTx);\n  return txResponse.hash;\n}\n","module.exports = \"data:image/png;base64,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\"","import React from \"react\";\n\ninterface TitleProps {\n  title: string;\n  subtitle?: string;\n}\n\nexport const Title: React.FunctionComponent<TitleProps> = ({\n  title,\n  subtitle,\n  children,\n}) => {\n  if (children) return <div className=\"section-title\">{children}</div>;\n  if (subtitle)\n    return (\n      <div className=\"section-title\">\n        <span className=\"pre-title\">{title} </span>\n        {subtitle}\n      </div>\n    );\n  return <div className=\"section-title\">{title}</div>;\n};\n","import React from \"react\";\n\nexport const SubTitle: React.FunctionComponent<{ className?: string }> = ({\n  children,\n  className,\n}) => <div className={`section-subtitle ${className || \"\"}`}>{children}</div>;\n","type CssClass =\n  | { [className: string]: string | undefined | null | boolean }\n  | string\n  | undefined\n  | null;\n\n/**\n *\n * @param cssClassObj\n */\nexport function joinCssClass(...args: CssClass[]): string {\n  return args\n    .reduce((classNames, arg) => {\n      if (typeof arg === \"string\") classNames.push(arg);\n      if (typeof arg === \"object\")\n        for (const [key, val] of Object.entries(arg || {}))\n          if (val) classNames.push(key);\n      return classNames;\n    }, [] as string[])\n    .join(\" \");\n}\n","import React from \"react\";\nimport BootstrapCard from \"react-bootstrap/Card\";\nimport { joinCssClass } from \"../utils/css\";\n\nconst shadowStyle = { boxShadow: \"1px 1px 15px 0 rgba(0, 0, 0, 0.07)\" };\n\ninterface CardProps {\n  shadow?: boolean;\n  spacing?: boolean;\n  divider?: boolean;\n  noscroll?: boolean;\n}\n\n/**\n * [NOTE] style is injected to the card-body div via ...props\n */\nexport const Card: React.FunctionComponent<\n  CardProps & React.HTMLAttributes<HTMLDivElement>\n> = ({\n  children,\n  className = \"\",\n  shadow,\n  spacing,\n  divider,\n  noscroll,\n  ...props\n}) => (\n  <BootstrapCard\n    style={{\n      overflowX: noscroll ? \"visible\" : \"auto\",\n      ...(shadow ? shadowStyle : {}),\n    }}\n  >\n    <BootstrapCard.Body\n      className={joinCssClass({\n        spacing,\n        divider,\n        noscroll,\n        [className]: className,\n      })}\n      {...props}\n    >\n      {children}\n    </BootstrapCard.Body>\n  </BootstrapCard>\n);\n","import React from \"react\";\nimport \"./errorView.css\";\n\nfunction parseError(\n  error: Error | { message: string; stack: string } | string\n) {\n  if (error instanceof Error || (typeof error === \"object\" && error.message))\n    return { message: error.message, detail: error.stack };\n  if (typeof error === \"string\") return { message: error };\n  return { message: JSON.stringify(error), detail: \"\" };\n}\n\nexport function ErrorView({ error }: { error: Error | string }) {\n  const { message, detail } = parseError(error);\n\n  return (\n    <div className=\"errorView\">\n      <details>\n        <summary>{message.split(\"\\n\")[0]}</summary>\n        <pre>{detail}</pre>\n      </details>\n    </div>\n  );\n}\n","import React, { useState, useEffect } from \"react\";\nimport ProgressBar from \"react-bootstrap/ProgressBar\";\n\nexport function LoadingView({ steps }: { steps?: string[] }) {\n  const [index, setIndex] = useState(0);\n  useEffect(() => {\n    const interval = setInterval(() => setIndex((i) => i + 1), 3000);\n    return () => clearInterval(interval);\n  }, []);\n\n  return (\n    <div className=\"loadingView\">\n      {steps && (\n        <div className=\"steps text-muted\">\n          {steps[index] || steps[steps.length - 1]}...\n        </div>\n      )}\n      <ProgressBar animated now={100} />\n    </div>\n  );\n}\n","/**\n * Type-safe helper to filter out nullist values from an array\n * ```js\n * const array: (string | null)[] = ['foo', null];\n * const filteredArray: string[] = array.filter(notEmpty);\n * ```\n * @param value\n */\nexport function notNullish<TValue>(\n  value: TValue | null | undefined\n): value is TValue {\n  return value !== null && value !== undefined;\n}\n","import { ethers } from \"ethers\";\nimport repoContract from \"contracts/repository.json\";\n\nexport async function apmRepoIsAllowed(\n  repoAddress: string,\n  userAddress: string,\n  provider: ethers.providers.Provider\n): Promise<boolean> {\n  const repo = new ethers.Contract(repoAddress, repoContract.abi, provider);\n\n  try {\n    return await repo.canPerform(\n      userAddress,\n      \"0x0000000000000000000000000000000000000000000000000000000000000001\",\n      []\n    );\n  } catch (e) {\n    // Rename error for user comprehension\n    e.message = `Error calling canPerform(${userAddress}): ${e.message}`;\n    throw e;\n  }\n}\n","import { ethers } from \"ethers\";\nimport repoContract from \"contracts/repository.json\";\n\nexport async function getLatestVersion(\n  repoAddress: string,\n  provider: ethers.providers.Provider\n): Promise<string> {\n  const repo = new ethers.Contract(repoAddress, repoContract.abi, provider);\n\n  try {\n    const res = await repo.getLatest();\n    return res.semanticVersion.join(\".\");\n  } catch (e) {\n    // Rename error for user comprehension\n    e.message = `Error getting latest version of ${repoAddress}: ${e.message}`;\n    throw e;\n  }\n}\n","import { manifestFileName } from \"params\";\nimport { Manifest } from \"types\";\n\nexport async function fetchManifest(\n  hash: string,\n  IPFS_GATEWAY: string\n): Promise<Manifest> {\n  try {\n    return await fetch(`${IPFS_GATEWAY}${hash}/${manifestFileName}`).then(\n      (res) => res.json()\n    );\n  } catch (e) {\n    return await fetch(`${IPFS_GATEWAY}${hash}`).then((res) => res.json());\n  }\n}\n","// IPFS\nexport const IPFS_GATEWAY = \"https://ipfs.io\";\n\nexport const SDK_GUIDE_LINK =\n  \"https://github.com/dappnode/DAppNodeSDK/wiki/DAppNode-SDK-tutorial\";\nexport const SDK_INSTALL_URL = \"https://github.com/dappnode/DAppNodeSDK\";\n\nexport const signatureFileName = \"signature.json\";\nexport const manifestFileName = \"dappnode_package.json\";\n","import semver from \"semver\";\n\nconst releaseTypes: semver.ReleaseType[] = [\"patch\", \"minor\", \"major\"];\n\nexport function isValidBump(prevVersion: string, nextVersion: string): boolean {\n  for (const type of releaseTypes) {\n    if (semver.inc(prevVersion, type) === nextVersion) return true;\n  }\n  return false;\n}\n","// @ts-ignore // No type definitions for \"is-ipfs\"\nimport isIPFS from \"is-ipfs\";\n\nfunction isMultihash(hash: string) {\n  return isIPFS.cid(hash);\n}\n\nexport function parseIpfsPath(hash: string): string {\n  if (hash.includes(\"ipfs/\")) {\n    hash = hash.split(\"ipfs/\")[1];\n  }\n  return hash;\n}\n\n/**\n * Checks if the given string is a valid IPFS CID or path\n *\n * isIPFS.cid('QmYjtig7VJQ6XsnUjqqJvj7QaMcCAwtrgNdahSiFofrE7o') // true (CIDv0)\n * isIPFS.cid('zdj7WWeQ43G6JJvLWQWZpyHuAMq6uYWRjkBXFad11vE2LHhQ7') // true (CIDv1)\n * isIPFS.cid('noop') // false\n *\n * @param hash\n */\nexport function isIpfsHash(hash: string): boolean {\n  if (!hash || typeof hash !== \"string\") return false;\n  // Correct hash prefix\n  hash = parseIpfsPath(hash);\n  hash.replace(\"/\", \"\");\n  // Make sure hash if valid\n  return isMultihash(hash);\n}\n","export function isValidEns(ensDomain: string): boolean {\n  return ensDomain.includes(\".\");\n}\n","// Props to be passed to a JSX <a> element to open a new tab\n// The purpose of this utility is to centralize this props.\n// To disable the newTab openning for certain <a> from the whole project, edit this file\n//\n// It converts:\n//   <a href={url} rel=\"noopener noreferrer\" target=\"_blank\">\n// Into:\n//   <a href={url} {...newTabProps}>\n\nexport const newTabProps = { rel: \"noopener noreferrer\", target: \"_blank\" };\n","const ipfsApiUrlsKey = \"ipfs-api-urls\";\n\nexport function readIpfsApiUrls(): string {\n  return localStorage.getItem(ipfsApiUrlsKey) ?? \"\";\n}\n\nexport function writeIpfsApiUrls(ipfsApiUrls: string): void {\n  localStorage.setItem(ipfsApiUrlsKey, ipfsApiUrls);\n}\n\n/**\n * `ipfsApiUrls` is a multiline newline separated list of IPFS URLs\n */\nexport function parseIpfsApiUrls(ipfsApiUrls: string): string[] {\n  return ipfsApiUrls\n    .trim()\n    .split(\"\\n\")\n    .map((row) => row.trim())\n    .filter((row) => row);\n}\n","import { create, CID } from \"ipfs-http-client\";\nimport { base58btc } from \"multiformats/bases/base58\";\nimport { base32 } from \"multiformats/bases/base32\";\nimport { base64, base64url } from \"multiformats/bases/base64\";\nimport { ethers } from \"ethers\";\nimport sortBy from \"lodash/sortBy\";\nimport { signatureFileName } from \"params\";\nimport { parseIpfsPath } from \"./isIpfsHash\";\n\nexport async function signRelease(\n  releaseHash: string,\n  ipfsApiUrls: string[]\n): Promise<string> {\n  if (ipfsApiUrls.length < 1) {\n    throw Error(\"ipfsApiUrls is empty\");\n  }\n\n  const ipfsArr = ipfsApiUrls.map((ipfsApiUrl) => create({ url: ipfsApiUrl }));\n  const [ipfs, ...ipfsExtras] = ipfsArr;\n\n  // Format release hash, remove prefix\n  const releaseCID = CID.parse(parseIpfsPath(releaseHash));\n\n  const releaseRootDag: IpfsDagGetResult<IpfsDagPbValue> = await ipfs.dag.get(\n    releaseCID\n  );\n\n  const releaseFilenames = dagGetToFilenames(releaseRootDag);\n  if (releaseFilenames.find((filename) => filename === signatureFileName)) {\n    throw Error(\"Release is already signed\");\n  }\n\n  const releaseFiles = dagGetToFiles(releaseRootDag);\n  const cidOpts: ReleaseSignature[\"cid\"] = { version: 0, base: \"base58btc\" };\n  const signedData = serializeIpfsDirectory(releaseFiles, cidOpts);\n\n  const provider = new ethers.providers.Web3Provider(window.ethereum);\n\n  // The Metamask plugin also allows signing transactions to\n  // send ether and pay to change state within the blockchain.\n  // For this, you need the account signer...\n  const signer = provider.getSigner();\n\n  const flatSig = await signer.signMessage(signedData);\n\n  const signature: ReleaseSignature = {\n    version: 1,\n    cid: cidOpts,\n    signature_protocol: \"ECDSA_256\",\n    signature: flatSig,\n  };\n\n  const signatureJson = JSON.stringify(signature, null, 2);\n  const signatureIpfsEntry = await ipfs.add(signatureJson);\n  // Upload to redundant nodes if any\n  for (const ipfsExtra of ipfsExtras) await ipfsExtra.add(signatureJson);\n\n  // Mutate dag-pb value appending a new Link\n  // TODO: What happens if the block becomes too big\n  releaseRootDag.value.Links.push({\n    Hash: signatureIpfsEntry.cid,\n    Name: signatureFileName,\n    Tsize: signatureIpfsEntry.size,\n  });\n\n  // DAG-PB form (links must be sorted by Name then bytes)\n  releaseRootDag.value.Links = sortBy(releaseRootDag.value.Links, [\n    \"Name\",\n    \"Bytes\",\n  ]);\n\n  console.log(releaseRootDag);\n\n  const dagProps = { format: \"dag-pb\", hashAlg: \"sha2-256\" };\n  const newReleaseCid = await ipfs.dag.put(releaseRootDag.value, dagProps);\n  // Upload to redundant nodes if any\n  for (const ipfsExtra of ipfsExtras)\n    await ipfsExtra.dag.put(releaseRootDag.value, dagProps);\n\n  // Validate that the new release hash contains all previous files + signature\n  const newReleaseRootDag = await ipfs.dag.get(newReleaseCid);\n  const newFilesStr = JSON.stringify(\n    dagGetToFilenames(newReleaseRootDag).sort()\n  );\n  const expectedFilesStr = JSON.stringify(\n    [...releaseFiles.map((file) => file.name), signatureFileName].sort()\n  );\n  if (newFilesStr !== expectedFilesStr) {\n    throw Error(`Wrong files in new release: ${newFilesStr}`);\n  }\n\n  return newReleaseCid.toV0().toString();\n}\n\ninterface IpfsDagPbValue {\n  Data: Uint8Array;\n  Links: {\n    Hash: CID;\n    /** \"dappnode_package.json\" */\n    Name: string;\n    /** 67 */\n    Tsize: number;\n  }[];\n}\n\ninterface IpfsDagGetResult<V> {\n  /**\n   * The value or node that was fetched during the get operation\n   */\n  value: V;\n\n  /**\n   * The remainder of the Path that the node was unable to resolve or what was left in a localResolve scenario\n   */\n  remainderPath?: string;\n}\n\n/**\n * Example serializing `QmRhdmquYoiMR5GB2dKqhLipMzdFUeyZ2eSVvTLDvndTvh` with v0 base58btc\n *\n * ```\n * avatar.png zdj7WnZ4Yn4ev7T8qSACAjqnErfqfQsCPsfrHuJNKcaAp7PkJ\n * dappmanager.dnp.dappnode.eth_0.2.43_linux-amd64.txz zdj7WifbEQAjxvDftqcMBFPVexDu4SmMF66NkcoPJjtHv9HJQ\n * dappmanager.dnp.dappnode.eth_0.2.43_linux-arm64.txz zdj7WhMmCV4ZRJQ981bqsZd9Wcu6rSMqgSqx8fKJcnbmRhB5H\n * dappmanager.dnp.dappnode.eth_0.2.43.tar.xz zdj7WifbEQAjxvDftqcMBFPVexDu4SmMF66NkcoPJjtHv9HJQ\n * dappnode_package.json zdj7WbUmsj617EgJRysWqPpzJxriYfmBxBo1uhAv3kqq6k3VJ\n * docker-compose.yml zdj7Wf2pYesVyvSbcTEwWVd8TFtTjv588FET9L7qgkP47kRkf\n * ```\n */\nfunction serializeIpfsDirectory(\n  files: { name: string; cid: CID }[],\n  opts: ReleaseSignature[\"cid\"]\n): string {\n  return (\n    files\n      .filter((file) => file.name !== signatureFileName)\n      // Sort alphabetically in descending order\n      .sort((a, b) => a.name.localeCompare(b.name))\n      /** `${name} ${cidStr}` */\n      .map((file) => {\n        const cidStr = cidToString(\n          getCidAtVersion(file.cid, opts.version),\n          opts.base\n        );\n        return `${file.name} ${cidStr}`;\n      })\n      .join(\"\\n\")\n  );\n}\n\ninterface ReleaseSignature {\n  /** Version of the ReleaseSignature format */\n  version: 1;\n  /** Specs of the signed CIDs */\n  cid: {\n    version: 0 | 1;\n    base: \"base58btc\" | \"base32\" | \"base64\" | \"base64url\";\n  };\n  signature_protocol: \"ECDSA_256\";\n  /**\n   * Signature of the serialized files in the directory\n   * ```\n   * 0x71b61418808a85c495f52bc9c781cbfeb0154c86aec8528c6cf7a83a26a0365f7ac4dea4eea7eea5e4ec14a10e01d8b8708d8c0c7c12420d152a272b69092b851b\n   * ```\n   */\n  signature: string;\n}\n\nfunction getCidAtVersion(cid: CID, version: number): CID {\n  switch (version) {\n    case 0:\n      return cid.toV0();\n    case 1:\n      return cid.toV1();\n    default:\n      throw Error(`Unknown CID version ${version}`);\n  }\n}\n\nfunction cidToString(cid: CID, base: string): string {\n  switch (base) {\n    case \"base58btc\":\n      return cid.toString(base58btc);\n    case \"base32\":\n      return cid.toString(base32);\n    case \"base64\":\n      return cid.toString(base64);\n    case \"base64url\":\n      return cid.toString(base64url);\n    default:\n      throw Error(`Unknown CID base ${base}`);\n  }\n}\n\ninterface IpfsDagGet {\n  Name: string;\n  Size: number;\n  Hash: string;\n}\n\nfunction dagGetToFiles(\n  content: IpfsDagGetResult<IpfsDagPbValue>\n): { name: string; cid: CID }[] {\n  return content.value.Links.map((link) => ({\n    cid: CID.parse(parseIpfsPath(link.Hash.toString())),\n    name: link.Name,\n  }));\n}\n\nfunction dagGetToFilenames(\n  content: IpfsDagGetResult<IpfsDagPbValue>\n): string[] {\n  return content.value.Links.map((link) => link.Name);\n}\n","import { signatureFileName } from \"params\";\nimport { parseIpfsPath } from \"./isIpfsHash\";\n\nexport async function fetchReleaseSignature(\n  hash: string,\n  IPFS_GATEWAY: string\n): Promise<string> {\n  hash = parseIpfsPath(hash);\n\n  const res = await fetch(`${IPFS_GATEWAY}/ipfs/${hash}/${signatureFileName}`);\n\n  if (!res.ok) {\n    throw Error(`Error ${res.statusText}`);\n  }\n\n  return await res.text();\n}\n","import React, { useState, useEffect, useMemo } from \"react\";\nimport { ethers } from \"ethers\";\nimport memoizee from \"memoizee\";\nimport { debounce } from \"lodash\";\nimport semver from \"semver\";\n// Components\nimport { Title } from \"components/Title\";\nimport { SubTitle } from \"components/SubTitle\";\nimport { Card } from \"components/Card\";\nimport { ErrorView } from \"components/ErrorView\";\nimport { LoadingView } from \"components/LoadingView\";\n// Utils\nimport { parseUrlQuery } from \"utils/urlQuery\";\nimport { notNullish } from \"utils/notNullish\";\nimport { executePublishTx } from \"utils/executePublishTx\";\nimport { apmRepoIsAllowed } from \"utils/apmRepoIsAllowed\";\nimport { getLatestVersion } from \"utils/getLatestVersion\";\nimport { fetchManifest } from \"utils/fetchManifest\";\nimport { resolveDnpName } from \"utils/resolveDnpName\";\nimport { isValidBump } from \"utils/isValidBump\";\nimport { isIpfsHash } from \"utils/isIpfsHash\";\nimport { isValidEns } from \"utils/isValidEns\";\nimport { newTabProps } from \"utils/newTabProps\";\nimport {\n  parseIpfsApiUrls,\n  readIpfsApiUrls,\n  writeIpfsApiUrls,\n} from \"./settings\";\n// Imgs\nimport metamaskIcon from \"./img/metamask-white.png\";\nimport { RequestStatus, RepoAddresses, Manifest, FormField } from \"types\";\nimport { IPFS_GATEWAY, SDK_INSTALL_URL } from \"params\";\nimport { signRelease } from \"utils/signRelease\";\nimport { fetchReleaseSignature } from \"utils/fetchRelease\";\n\nconst fetchManifestMem = memoizee(fetchManifest, { promise: true });\nconst resolveDnpNameMem = memoizee(resolveDnpName, { promise: true });\nconst getLatestVersionMem = memoizee(getLatestVersion, { promise: true });\n\n/**\n * Convert to react-boostrap classes\n */\nconst getInputClass = ({\n  success,\n  error,\n}: {\n  success?: boolean;\n  error?: boolean;\n}) => (error ? \"is-invalid\" : success ? \"is-valid\" : \"\");\n\nexport function App() {\n  // Settings\n  const [showSettings, setShowSettings] = useState(false);\n  const [ipfsApiUrls, setIpfsApiUrls] = useState(readIpfsApiUrls());\n  // Form input variables\n  const [dnpName, setDnpName] = useState(\"\");\n  const [version, setVersion] = useState(\"\");\n  const [developerAddress, setDeveloperAddress] = useState(\"\");\n  const [releaseHash, setReleaseHash] = useState(\"\");\n  const [manifest, setManifest] = useState<Manifest & { hash: string }>();\n  const [isSigned, setIsSigned] = useState<boolean | null>(null);\n  const [repoAddresses, setRepoAddresses] = useState<RepoAddresses>();\n  const [latestVersion, setLatestVersion] = useState<string>();\n  const [providerReq, setProviderReq] = useState<\n    RequestStatus<ethers.providers.Web3Provider>\n  >({});\n  const [signReq, setSignReq] = useState<RequestStatus<string>>({});\n  const [publishReqStatus, setPublishReqStatus] = useState<\n    RequestStatus<string>\n  >({});\n\n  // Precomputed variables\n  const provider = providerReq.result;\n\n  // Persist apiUrls settings\n  useEffect(() => writeIpfsApiUrls(ipfsApiUrls), [ipfsApiUrls]);\n\n  /**\n   * Grab the params from the URL and update local state\n   * - Only once every mount, unmount\n   */\n  useEffect(() => {\n    const urlParams = parseUrlQuery(window.location.search);\n    console.log(\"URL params\", urlParams);\n    if (urlParams.r) setDnpName(urlParams.r);\n    if (urlParams.v) setVersion(urlParams.v);\n    if (urlParams.d) setDeveloperAddress(urlParams.d);\n    if (urlParams.h) setReleaseHash(urlParams.h);\n  }, []);\n\n  useEffect(() => {\n    // Necessary code to refresh the userAddress\n    // when user interacts with the metamask extension\n    // @ts-ignore\n    const ethereum = window.ethereum;\n    if (ethereum)\n      ethereum.on(\"accountsChanged\", (accounts: string[]) => {\n        console.log(\"new user account\", accounts[0]);\n      });\n  }, []);\n\n  // Check manifest for manifestHash\n\n  const onNewManifestHash = useMemo(\n    () =>\n      debounce((hash: string) => {\n        fetchManifestMem(hash, IPFS_GATEWAY)\n          .then((manifest) => setManifest({ ...manifest, hash }))\n          .catch((e) => console.error(`Error fetching manifest ${hash}`, e));\n\n        fetchReleaseSignature(hash, IPFS_GATEWAY)\n          .then(() => setIsSigned(true))\n          .catch((e) => {\n            console.error(`Error fetching release ${hash}`, e);\n            setIsSigned(false);\n          });\n      }, 500),\n    []\n  );\n  const onNewDnpName = useMemo(\n    () =>\n      debounce((dnpName: string, provider: ethers.providers.Provider) => {\n        console.log(\"ON NEW DNP\", dnpName);\n        resolveDnpNameMem(dnpName, provider)\n          .then(setRepoAddresses)\n          .catch((e) => console.error(`Error resolving dnpName ${dnpName}`, e));\n        getLatestVersionMem(dnpName, provider)\n          .then(setLatestVersion)\n          .catch((e) => console.error(`Error get latest ver ${dnpName}`, e));\n      }, 500),\n    []\n  );\n\n  useEffect(() => {\n    if (releaseHash) onNewManifestHash(releaseHash);\n  }, [releaseHash, onNewManifestHash]);\n\n  useEffect(() => {\n    if (dnpName && isValidEns(dnpName) && provider)\n      onNewDnpName(dnpName, provider);\n  }, [dnpName, provider, onNewDnpName]);\n\n  async function connectToMetamask() {\n    try {\n      setProviderReq({ loading: true });\n      // Modern dapp browsers...\n      if (window.ethereum) {\n        // Request account access if needed\n        await window.ethereum.enable();\n        // Acccounts now exposed\n        setProviderReq({\n          result: new ethers.providers.Web3Provider(window.ethereum),\n        });\n      }\n      // Legacy dapp browsers...\n      else if (window.web3) {\n        setProviderReq({\n          result: new ethers.providers.Web3Provider(\n            window.web3.currentProvider\n          ),\n        });\n      }\n      // Non-dapp browsers...\n      else {\n        throw Error(\"Non-Ethereum browser detected. Please, install MetaMask\");\n      }\n    } catch (e) {\n      console.error(e);\n      setProviderReq({ error: e as Error });\n    }\n  }\n\n  async function doSignRelease() {\n    try {\n      setSignReq({ loading: true });\n      // newReleaseHash is not prefixed by '/ipfs/'\n      const newReleaseHash = await signRelease(\n        releaseHash,\n        parseIpfsApiUrls(ipfsApiUrls)\n      );\n      setSignReq({ result: newReleaseHash });\n      setReleaseHash(`/ipfs/${newReleaseHash}`);\n    } catch (e) {\n      console.error(e);\n      setSignReq({ error: e as Error });\n    }\n  }\n\n  async function publish() {\n    try {\n      if (!dnpName) throw Error(\"Must provide a dnpName\");\n      if (!version) throw Error(\"Must provide a version\");\n      if (!releaseHash) throw Error(\"Must provide a manifestHash\");\n\n      setPublishReqStatus({ loading: true });\n\n      if (!provider) throw Error(`Must connect to Metamask first`);\n      const network = await provider.getNetwork();\n\n      if (network && String(network.chainId) !== \"1\")\n        throw Error(\"Transactions must be published on Ethereum Mainnet\");\n\n      const accounts = await provider.listAccounts();\n      const userAddress = accounts[0];\n      if (userAddress) {\n        const { repoAddress } = await resolveDnpNameMem(dnpName, provider);\n        if (repoAddress) {\n          const isAllowed = await apmRepoIsAllowed(\n            repoAddress,\n            userAddress,\n            provider\n          );\n          if (!isAllowed)\n            throw Error(\n              `Selected address ${userAddress} is not allowed to publish`\n            );\n        }\n      }\n\n      const txHash = await executePublishTx(\n        { dnpName, version, manifestHash: releaseHash, developerAddress },\n        provider\n      );\n      setPublishReqStatus({ result: txHash });\n    } catch (e) {\n      console.error(e);\n      setPublishReqStatus({ error: e as Error });\n    }\n  }\n\n  /**\n   * Description of the input fields\n   */\n  const fields: FormField[] = [\n    {\n      id: \"dnpName\",\n      name: \"DAppNode Package name\",\n      placeholder: \"full ENS name\",\n      help: \"ENS name of the DAppNode Package to update, i.e. timeapp.public.dappnode.eth\",\n      value: dnpName,\n      onValueChange: setDnpName,\n      validations: [\n        dnpName\n          ? isValidEns(dnpName)\n            ? { isValid: true, message: \"Valid ENS domain\" }\n            : { isValid: false, message: \"Invalid ENS domain\" }\n          : null,\n        dnpName && repoAddresses\n          ? repoAddresses.registryAddress\n            ? repoAddresses.repoAddress\n              ? {\n                  isValid: true,\n                  message: `Repo already deployed at: ${repoAddresses.repoAddress}`,\n                }\n              : {\n                  isValid: true,\n                  message: `New repo to be deployed for ${dnpName}`,\n                }\n            : {\n                isValid: false,\n                message: `No valid registry found for ${dnpName}`,\n              }\n          : null,\n      ],\n    },\n    {\n      id: \"developerAddress\",\n      name: \"Developer address\",\n      placeholder: \"Ethereum address\",\n      help: \"Developer's Ethereum address that will control this repo\",\n      value: developerAddress,\n      onValueChange: setDeveloperAddress,\n      validations: [\n        developerAddress\n          ? ethers.utils.isAddress(developerAddress)\n            ? { isValid: true, message: \"Valid address\" }\n            : { isValid: false, message: \"Must be a valid ethereum address\" }\n          : null,\n      ],\n    },\n    {\n      id: \"version\",\n      name: \"Next version\",\n      placeholder: \"Semantic version\",\n      help: \"Semantic version about to be published, i.e. 0.1.7\",\n      value: version,\n      onValueChange: setVersion,\n      validations: [\n        version\n          ? semver.valid(version)\n            ? { isValid: true, message: \"Valid semver\" }\n            : { isValid: false, message: \"Invalid semver\" }\n          : null,\n        version && latestVersion\n          ? isValidBump(latestVersion, version)\n            ? { isValid: true, message: `Valid bump from ${latestVersion}` }\n            : { isValid: false, message: \"Next version is not a valid bump\" }\n          : null,\n      ],\n    },\n    {\n      id: \"releaseIpfsHash\",\n      name: \"Release hash\",\n      placeholder: \"IPFS multihash\",\n      help: \"IPFS hash of the release. Must be in the format /ipfs/[multihash], i.e. /ipfs/QmVeaz5kR55nAiGjYpXpUAJpWvf6net4MbGFNjBfMTS8xS\",\n      value: releaseHash,\n      onValueChange: setReleaseHash,\n      validations: [\n        releaseHash\n          ? isIpfsHash(releaseHash)\n            ? { isValid: true, message: \"Valid ipfs hash\" }\n            : { isValid: false, message: \"Invalid ipfs hash\" }\n          : null,\n        manifest &&\n        releaseHash &&\n        releaseHash === manifest.hash &&\n        manifest.name &&\n        manifest.version\n          ? manifest.name === dnpName && manifest.version === version\n            ? { isValid: true, message: \"Manifest successfully verified\" }\n            : {\n                isValid: false,\n                message: `Manifest verification failed. This manifest is for ${manifest.name} @ ${manifest.version}`,\n              }\n          : null,\n        isSigned === true\n          ? { isValid: true, message: \"Release is signed\" }\n          : isSigned === false\n          ? { isValid: false, message: \"Release not signed\" }\n          : null,\n      ],\n    },\n  ];\n\n  return (\n    <div className=\"app\">\n      <Title title=\"SDK\" subtitle=\"Publish\" />\n      <div className=\"mt-3 text-muted\">\n        <p>\n          This tool is part of the DAppNode Software Development Kit\n          (dappnodesdk) and allows to sign DAppNode package release transactions\n          with Metamask.\n        </p>\n        {!window.location.search && (\n          <div\n            className=\"alert alert-secondary\"\n            role=\"alert\"\n            style={{ backgroundColor: \"#f1f1f3\" }}\n          >\n            To generate a pre-filled URL with the parameters to publish a\n            release transaction install{\" \"}\n            <a href={SDK_INSTALL_URL} {...newTabProps}>\n              <code>@dappnode/dappnodesdk</code>\n            </a>\n          </div>\n        )}\n      </div>\n      <SubTitle>Transaction details</SubTitle>\n      <Card>\n        <div className=\"publish-grid\">\n          {fields.map((field) => {\n            const validations = (field.validations || []).filter(notNullish);\n            const success = validations.filter((v) => v && v.isValid);\n            const errors = validations.filter((v) => v && !v.isValid);\n            return (\n              <React.Fragment key={field.name}>\n                <div className=\"field-name\">{field.name}</div>\n                <div>\n                  <input\n                    className={`form-control ${getInputClass({\n                      error: errors.length > 0,\n                      success: success.length > 0,\n                    })}`}\n                    placeholder={field.placeholder}\n                    value={field.value}\n                    onChange={(e) => field.onValueChange(e.target.value)}\n                  />\n                  {success.map((item, i) => (\n                    <div key={i} className=\"valid-feedback\">\n                      <div>{item.message}</div>\n                    </div>\n                  ))}\n                  {errors.map((item, i) => (\n                    <div key={i} className=\"invalid-feedback\">\n                      <div>{item.message}</div>\n                    </div>\n                  ))}\n                  <small className=\"form-text text-muted help\">\n                    {field.help}\n                  </small>\n                </div>\n              </React.Fragment>\n            );\n          })}\n\n          {/* Empty left cell */}\n          <div />\n          <div className=\"bottom-section\">\n            {/* Publish button */}\n            <div className=\"bottom-buttons\">\n              {provider ? (\n                <button\n                  className=\"btn btn-dappnode\"\n                  disabled={publishReqStatus.loading}\n                  onClick={publish}\n                >\n                  Publish\n                </button>\n              ) : (\n                <button\n                  className=\"btn btn-dappnode\"\n                  disabled={providerReq.loading}\n                  onClick={connectToMetamask}\n                >\n                  <img src={metamaskIcon} alt=\"\" className=\"metamaskIcon\" />{\" \"}\n                  Connect to Metamask\n                </button>\n              )}\n              {providerReq.result && (\n                <button\n                  className=\"btn btn-dappnode\"\n                  disabled={signReq.loading || isSigned === true}\n                  onClick={doSignRelease}\n                >\n                  Sign release\n                </button>\n              )}\n            </div>\n\n            {providerReq.error && <ErrorView error={providerReq.error} />}\n            {providerReq.loading && (\n              <LoadingView steps={[\"Connecting to Metamask\"]} />\n            )}\n            {signReq.error && <ErrorView error={signReq.error} />}\n            {signReq.loading && <LoadingView steps={[\"Signing release\"]} />}\n            {publishReqStatus.error && (\n              <ErrorView error={publishReqStatus.error} />\n            )}\n            {publishReqStatus.loading && (\n              <LoadingView steps={[\"Publishing release transaction\"]} />\n            )}\n            {publishReqStatus.result && (\n              <div className=\"feedback-success\">\n                Published transaction! Tx hash: {publishReqStatus.result}\n              </div>\n            )}\n          </div>\n        </div>\n      </Card>\n\n      {showSettings ? (\n        <>\n          <SubTitle>Settings</SubTitle>\n          <Card>\n            <div className=\"field-name\">IPFS API URLs</div>\n            <p className=\"text-muted\">\n              You can specify multiple URLs, to facilitate propagation of the\n              signed release\n            </p>\n            <textarea\n              className={\"form-control\"}\n              placeholder=\"https://ipfs.infura.io:5001 &#13;&#10;http://your-own-ipfs-node:5001\"\n              value={ipfsApiUrls}\n              onChange={(e) => setIpfsApiUrls(e.target.value)}\n            />\n          </Card>\n        </>\n      ) : (\n        <div className=\"settings-container\">\n          <span\n            className=\"show-settings text-muted\"\n            onClick={() => setShowSettings(true)}\n          >\n            Edit settings\n          </span>\n        </div>\n      )}\n    </div>\n  );\n}\n","/**\n * Parses url params into an object\n * Sample params:\n * - timeapp.public.dappnode.eth\n * - 0.1.16\n * - /ipfs/QmSDgpiHco5yXdyVTfhKxr3aiJ82ynz8V14QcGKicM3rVh\n * @param params\n * @returns\n */\nexport const parseUrlQuery = (params = \"\") => {\n  if (params.startsWith(\"?\")) params = params.slice(1);\n  return params.split(\"&\").reduce((obj: { [key: string]: string }, pair) => {\n    const [key, value] = pair.split(\"=\");\n    obj[key] = decodeURIComponent(value);\n    return obj;\n  }, {});\n};\n\n/**\n * Reverse of parseUrlQuery, such that:\n *   params = stringifyUrlQuery(parseUrlQuery(params))\n * @param obj\n * @returns params\n */\nexport const stringifyUrlQuery = (obj: { [key: string]: string }) =>\n  Object.keys(obj)\n    .map((key) => `${key}=${encodeURIComponent(obj[key])}`)\n    .join(\"&\");\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { App } from \"./App\";\nimport \"bootstrap/dist/css/bootstrap.min.css\";\nimport \"./app.css\";\nimport \"./index.css\";\nimport \"./layout.css\";\nimport \"./dappnode_styles.css\";\nimport \"./dappnode_colors.css\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n","import { ethers } from \"ethers\";\nimport { RepoAddresses } from \"types\";\n\nexport async function resolveDnpName(\n  dnpName: string,\n  provider: ethers.providers.Provider\n): Promise<RepoAddresses> {\n  const registryName = parseRegistryName(dnpName);\n  const [registryAddress, repoAddress] = await Promise.all([\n    resolveEns(registryName, provider),\n    resolveEns(dnpName, provider),\n  ]);\n  return { registryAddress, repoAddress };\n}\n\n// Ens throws if a node is not found\n//\n// ens.resolver('admin.dnp.dappnode.eth').addr()\n// ==> 0xee66c4765696c922078e8670aa9e6d4f6ffcc455\n// ens.resolver('fake.dnp.dappnode.eth').addr()\n// ==> Unhandled rejection Error: ENS name not found\n//\n// Change behaviour to return null if not found\nasync function resolveEns(\n  ensName: string,\n  provider: ethers.providers.Provider\n): Promise<string | null> {\n  try {\n    return await provider.resolveName(ensName);\n  } catch (e) {\n    if (e.message.includes(\"not found\")) return null;\n    else throw e;\n  }\n}\n\nfunction parseRegistryName(repoName: string): string {\n  return repoName.split(\".\").slice(1).join(\".\");\n}\n"],"sourceRoot":""}
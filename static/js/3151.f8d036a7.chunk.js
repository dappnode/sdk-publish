"use strict";(self.webpackChunkpublish=self.webpackChunkpublish||[]).push([[3151],{34087:(t,e,n)=>{n.d(e,{u:()=>h});var i=n(49477),o=n(80883),r=n(595),a=n(16496),s=n(65618),l=n(17321),c=n(60205),u=n(99632);class d{constructor(t){this.getNonce=t.getNonce}async createMessage(t){const e={accountAddress:t.accountAddress,chainId:t.chainId,version:"1",domain:"undefined"===typeof document?"Unknown Domain":document.location.host,uri:"undefined"===typeof document?"Unknown URI":document.location.href,resources:this.resources,nonce:await this.getNonce(t),issuedAt:this.stringifyDate(new Date),statement:void 0,expirationTime:void 0,notBefore:void 0},n={toString:()=>this.stringify(e)};return Object.assign(e,n)}stringify(t){var e;const n=this.getNetworkName(t.chainId);return["".concat(t.domain," wants you to sign in with your ").concat(n," account:"),t.accountAddress,t.statement?"\n".concat(t.statement,"\n"):"","URI: ".concat(t.uri),"Version: ".concat(t.version),"Chain ID: ".concat(t.chainId),"Nonce: ".concat(t.nonce),t.issuedAt&&"Issued At: ".concat(t.issuedAt),t.expirationTime&&"Expiration Time: ".concat(t.expirationTime),t.notBefore&&"Not Before: ".concat(t.notBefore),t.requestId&&"Request ID: ".concat(t.requestId),(null===(e=t.resources)||void 0===e?void 0:e.length)&&t.resources.reduce(((t,e)=>"".concat(t,"\n- ").concat(e)),"Resources:")].filter((t=>"string"===typeof t)).join("\n").trim()}getNetworkName(t){const e=l.W.getAllRequestedCaipNetworks();return u.L.getNetworkNameByCaipNetworkId(e,t)}stringifyDate(t){return t.toISOString()}}class h{constructor(){var t;let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.otpUuid=null,this.listeners={sessionChanged:[]},this.localAuthStorageKey=e.localAuthStorageKey||i.Ws.SIWX_AUTH_TOKEN,this.localNonceStorageKey=e.localNonceStorageKey||i.Ws.SIWX_NONCE_TOKEN,this.required=null===(t=e.required)||void 0===t||t,this.messenger=new d({getNonce:this.getNonce.bind(this)})}async createMessage(t){return this.messenger.createMessage(t)}async addSession(t){const e=await this.request({method:"POST",key:"authenticate",body:{data:t.data,message:t.message,signature:t.signature,clientId:this.getClientId(),walletInfo:this.getWalletInfo()},headers:["nonce","otp"]});this.setStorageToken(e.token,this.localAuthStorageKey),this.emit("sessionChanged",t),this.setAppKitAccountUser(function(t){const e=t.split(".");if(3!==e.length)throw new Error("Invalid token");const n=e[1];if("string"!==typeof n)throw new Error("Invalid token");const i=n.replace(/-/gu,"+").replace(/_/gu,"/"),o=i.padEnd(i.length+(4-i.length%4)%4,"=");return JSON.parse(atob(o))}(e.token)),this.otpUuid=null}async getSessions(t,e){try{if(!this.getStorageToken(this.localAuthStorageKey))return[];const n=await this.request({method:"GET",key:"me",query:{},headers:["auth"]});if(!n)return[];const i=n.address.toLowerCase()===e.toLowerCase(),o=n.caip2Network===t;if(!i||!o)return[];const r={data:{accountAddress:n.address,chainId:n.caip2Network},message:"",signature:""};return this.emit("sessionChanged",r),this.setAppKitAccountUser(n),[r]}catch{return[]}}async revokeSession(t,e){return Promise.resolve(this.clearStorageTokens())}async setSessions(t){if(0===t.length)this.clearStorageTokens();else{const e=t.find((t=>{var e;return t.data.chainId===(null===(e=(0,c.kg)())||void 0===e?void 0:e.caipNetworkId)}))||t[0];await this.addSession(e)}}getRequired(){return this.required}async getSessionAccount(){if(!this.getStorageToken(this.localAuthStorageKey))throw new Error("Not authenticated");return this.request({method:"GET",key:"me",body:void 0,query:{includeAppKitAccount:!0},headers:["auth"]})}async setSessionAccountMetadata(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(!this.getStorageToken(this.localAuthStorageKey))throw new Error("Not authenticated");return this.request({method:"PUT",key:"account-metadata",body:{metadata:t},headers:["auth"]})}on(t,e){return this.listeners[t].push(e),()=>{this.listeners[t]=this.listeners[t].filter((t=>t!==e))}}removeAllListeners(){Object.keys(this.listeners).forEach((t=>{this.listeners[t]=[]}))}async requestEmailOtp(t){let{email:e,account:n}=t;const i=await this.request({method:"POST",key:"otp",body:{email:e,account:n}});return this.otpUuid=i.uuid,this.messenger.resources=["email:".concat(e)],i}confirmEmailOtp(t){let{code:e}=t;return this.request({method:"PUT",key:"otp",body:{code:e},headers:["otp"]})}async request(t){var e;let{method:n,key:i,query:r,body:a,headers:s}=t;const{projectId:l,st:c,sv:u}=this.getSDKProperties(),d=new URL("".concat(o.o.W3M_API_URL,"/auth/v1/").concat(String(i)));d.searchParams.set("projectId",l),d.searchParams.set("st",c),d.searchParams.set("sv",u),r&&Object.entries(r).forEach((t=>{let[e,n]=t;return d.searchParams.set(e,String(n))}));const h=await fetch(d,{method:n,body:a?JSON.stringify(a):void 0,headers:Array.isArray(s)?s.reduce(((t,e)=>{switch(e){case"nonce":t["x-nonce-jwt"]="Bearer ".concat(this.getStorageToken(this.localNonceStorageKey));break;case"auth":t.Authorization="Bearer ".concat(this.getStorageToken(this.localAuthStorageKey));break;case"otp":this.otpUuid&&(t["x-otp"]=this.otpUuid)}return t}),{}):void 0});if(!h.ok)throw new Error(await h.text());return null!==(e=h.headers.get("content-type"))&&void 0!==e&&e.includes("application/json")?h.json():null}getStorageToken(t){return i.Ud.getItem(t)}setStorageToken(t,e){i.Ud.setItem(e,t)}clearStorageTokens(){this.otpUuid=null,i.Ud.removeItem(this.localAuthStorageKey),i.Ud.removeItem(this.localNonceStorageKey),this.emit("sessionChanged",void 0)}async getNonce(){const{nonce:t,token:e}=await this.request({method:"GET",key:"nonce"});return this.setStorageToken(e,this.localNonceStorageKey),t}getClientId(){return s.T.state.clientId}getWalletInfo(){const{connectedWalletInfo:t}=r.U.state;if(!t)return;if("social"in t){return{type:"social",social:t.social,identifier:t.identifier}}const{name:e,icon:n}=t;let i="unknown";switch(t.type){case"EXTERNAL":case"INJECTED":case"ANNOUNCED":i="extension";break;case"WALLET_CONNECT":i="walletconnect";break;default:i="unknown"}return{type:i,name:e,icon:n}}getSDKProperties(){return a.N._getSdkProperties()}emit(t,e){this.listeners[t].forEach((t=>t(e)))}setAppKitAccountUser(t){const{email:e}=t;e&&Object.values(o.o.CHAIN).forEach((t=>{l.W.setAccountProp("user",{email:e},t)}))}}},93151:(t,e,n)=>{n.r(e),n.d(e,{W3mDataCaptureOtpConfirmView:()=>T,W3mDataCaptureView:()=>H,W3mEmailSuffixesWidget:()=>p,W3mRecentEmailsWidget:()=>y});var i,o=n(57528),r=n(37022),a=n(56370),s=n(89268);const l=(0,r.AH)(i||(i=(0,o.A)(["\n  .email-sufixes {\n    display: flex;\n    flex-direction: row;\n    gap: var(--wui-spacing-3xs);\n    overflow-x: auto;\n    max-width: 100%;\n    margin-top: var(--wui-spacing-s);\n    margin-bottom: calc(-1 * var(--wui-spacing-m));\n    padding-bottom: var(--wui-spacing-m);\n    margin-left: calc(-1 * var(--wui-spacing-m));\n    margin-right: calc(-1 * var(--wui-spacing-m));\n    padding-left: var(--wui-spacing-m);\n    padding-right: var(--wui-spacing-m);\n\n    &::-webkit-scrollbar {\n      display: none;\n    }\n  }\n"])));var c,u,d=function(t,e,n,i){var o,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,n,a):o(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};const h=["@gmail.com","@outlook.com","@yahoo.com","@hotmail.com","@aol.com","@icloud.com","@zoho.com"];let p=class extends r.WF{constructor(){super(...arguments),this.email=""}render(){const t=h.filter(this.filter.bind(this)).map(this.item.bind(this));return 0===t.length?null:(0,r.qy)(c||(c=(0,o.A)(['<div class="email-sufixes">',"</div>"])),t)}filter(t){if(!this.email)return!1;const e=this.email.split("@");if(e.length<2)return!0;const n=e.pop();return t.includes(n)&&t!=="@".concat(n)}item(t){return(0,r.qy)(u||(u=(0,o.A)(['<wui-button variant="neutral" size="sm" @click=',"\n      >","</wui-button\n    >"])),(()=>{const e=this.email.split("@");e.length>1&&e.pop();const n=e[0]+t;this.dispatchEvent(new CustomEvent("change",{detail:n,bubbles:!0,composed:!0}))}),t)}};var m;p.styles=[l],d([(0,a.MZ)()],p.prototype,"email",void 0),p=d([(0,s.EM)("w3m-email-suffixes-widget")],p);const g=(0,r.AH)(m||(m=(0,o.A)(["\n  .recent-emails {\n    display: flex;\n    flex-direction: column;\n    padding: var(--wui-spacing-s) 0;\n    border-top: 1px solid var(--wui-color-gray-glass-005);\n    border-bottom: 1px solid var(--wui-color-gray-glass-005);\n  }\n\n  .recent-emails-heading {\n    margin-bottom: var(--wui-spacing-s);\n  }\n\n  .recent-emails-list-item {\n    --wui-color-gray-glass-002: transparent;\n  }\n"])));var w,f,v=function(t,e,n,i){var o,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,n,a):o(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};let y=class extends r.WF{constructor(){super(...arguments),this.emails=[]}render(){return 0===this.emails.length?null:(0,r.qy)(w||(w=(0,o.A)(['<div class="recent-emails">\n      <wui-text variant="micro-600" color="fg-200" class="recent-emails-heading"\n        >Recently used emails</wui-text\n      >\n      ',"\n    </div>"])),this.emails.map(this.item.bind(this)))}item(t){return(0,r.qy)(f||(f=(0,o.A)(["<wui-list-item\n      @click=","\n      ?chevron=",'\n      icon="mail"\n      iconVariant="overlay"\n      class="recent-emails-list-item"\n    >\n      <wui-text variant="paragraph-500" color="fg-100">',"</wui-text>\n    </wui-list-item>"])),(()=>{this.dispatchEvent(new CustomEvent("select",{detail:t,bubbles:!0,composed:!0}))}),!0,t)}};y.styles=[g],v([(0,a.MZ)()],y.prototype,"emails",void 0),y=v([(0,s.EM)("w3m-recent-emails-widget")],y);var b=n(42661),x=n(61139),k=n(17321),A=n(7258),E=n(34087),I=n(41722),S=function(t,e,n,i){var o,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,n,a):o(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};let T=class extends I.H{constructor(){super(...arguments),this.siwx=b.H.state.siwx,this.onOtpSubmit=async t=>{await this.siwx.confirmEmailOtp({code:t}),x.I.replace("SIWXSignMessage")},this.onOtpResend=async t=>{const e=k.W.getAccountData();if(null===e||void 0===e||!e.caipAddress)throw new Error("No account data found");await this.siwx.requestEmailOtp({email:t,account:e.caipAddress})}}connectedCallback(){this.siwx&&this.siwx instanceof E.u||A.P.showError("ReownAuthentication is not initialized."),super.connectedCallback()}shouldSubmitOnOtpChange(){return this.otp.length===I.H.OTP_LENGTH}};S([(0,a.wk)()],T.prototype,"siwx",void 0),T=S([(0,s.EM)("w3m-data-capture-otp-confirm-view")],T);var O,R=n(49477);const C=(0,r.AH)(O||(O=(0,o.A)(["\n  .hero {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    gap: var(--wui-spacing-3xs);\n\n    transition-property: margin, height;\n    transition-duration: var(--wui-duration-md);\n    transition-timing-function: var(--wui-ease-out-power-1);\n    margin-top: -100px;\n\n    &[data-state='loading'] {\n      margin-top: 0px;\n    }\n\n    position: relative;\n    &:after {\n      content: '';\n      position: absolute;\n      bottom: 0;\n      height: 252px;\n      width: 360px;\n      background: radial-gradient(\n        96.11% 53.95% at 50% 51.28%,\n        transparent 0%,\n        color-mix(in srgb, var(--wui-color-bg-100) 5%, transparent) 49%,\n        color-mix(in srgb, var(--wui-color-bg-100) 65%, transparent) 99.43%\n      );\n    }\n  }\n\n  .hero-main-icon {\n    width: 176px;\n    transition-property: background-color;\n    transition-duration: var(--wui-duration-lg);\n    transition-timing-function: var(--wui-ease-out-power-1);\n\n    &[data-state='loading'] {\n      width: 56px;\n    }\n  }\n\n  .hero-row {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    justify-content: center;\n    gap: var(--wui-spacing-3xs);\n    flex-wrap: nowrap;\n    min-width: fit-content;\n\n    &:nth-child(1) {\n      transform: translateX(-30px);\n    }\n\n    &:nth-child(2) {\n      transform: translateX(30px);\n    }\n\n    &:nth-child(4) {\n      transform: translateX(40px);\n    }\n\n    transition-property: height;\n    transition-duration: var(--wui-duration-md);\n    transition-timing-function: var(--wui-ease-out-power-1);\n    height: 68px;\n\n    &[data-state='loading'] {\n      height: 0px;\n    }\n  }\n\n  .hero-row-icon {\n    opacity: 0.1;\n    transition-property: opacity;\n    transition-duration: var(--wui-duration-md);\n    transition-timing-function: var(--wui-ease-out-power-1);\n\n    &[data-state='loading'] {\n      opacity: 0;\n    }\n  }\n"])));var N,q,P,W,D,j,L,U,K,M,z,F=function(t,e,n,i){var o,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,n,a):o(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};let H=class extends r.WF{constructor(){var t,e,n,i,o,r,a,s,l,c;super(...arguments),this.email=null!==(t=null!==(e=null===(n=x.I.state.data)||void 0===n?void 0:n.email)&&void 0!==e?e:null===(i=k.W.getAccountData())||void 0===i||null===(i=i.user)||void 0===i?void 0:i.email)&&void 0!==t?t:"",this.address=null!==(o=null===(r=k.W.getAccountData())||void 0===r?void 0:r.address)&&void 0!==o?o:"",this.loading=!1,this.appName=null!==(a=null===(s=b.H.state.metadata)||void 0===s?void 0:s.name)&&void 0!==a?a:"AppKit",this.siwx=b.H.state.siwx,this.isRequired=Array.isArray(null===(l=b.H.state.remoteFeatures)||void 0===l?void 0:l.emailCapture)&&(null===(c=b.H.state.remoteFeatures)||void 0===c?void 0:c.emailCapture.includes("required")),this.recentEmails=this.getRecentEmails()}connectedCallback(){this.siwx&&this.siwx instanceof E.u||A.P.showError("ReownAuthentication is not initialized. Please contact support."),super.connectedCallback()}firstUpdated(){this.loading=!1,this.recentEmails=this.getRecentEmails(),this.email&&this.onSubmit()}render(){return(0,r.qy)(N||(N=(0,o.A)(['\n      <wui-flex flexDirection="column" .padding=',' gap="l">\n        '," "," "," ","\n        ","\n      </wui-flex>\n    "])),["3xs","m","m","m"],this.hero(),this.paragraph(),this.emailInput(),this.recentEmailsWidget(),this.footerActions())}hero(){return(0,r.qy)(q||(q=(0,o.A)(['\n      <div class="hero" data-state=',">\n        ","\n        ",'\n        <div class="hero-row">\n          '," ",'\n          <wui-icon-box\n            size="xl"\n            iconSize="xxl"\n            iconColor=',"\n            backgroundColor=","\n            icon=",'\n            isOpaque\n            class="hero-main-icon"\n            data-state=',"\n          >\n          </wui-icon-box>\n          "," ","\n        </div>\n        ","\n      </div>\n    "])),this.loading?"loading":"default",this.heroRow(["id","mail","wallet","x","solana","qrCode"]),this.heroRow(["mail","farcaster","wallet","discord","mobile","qrCode"]),this.heroIcon("github"),this.heroIcon("bank"),this.loading?"fg-100":"accent-100",this.loading?"fg-100":"accent-100",this.loading?"id":"user",this.loading?"loading":"default",this.heroIcon("id"),this.heroIcon("card"),this.heroRow(["google","id","github","verify","apple","mobile"]))}heroRow(t){return(0,r.qy)(P||(P=(0,o.A)(['\n      <div class="hero-row" data-state=',">\n        ","\n      </div>\n    "])),this.loading?"loading":"default",t.map(this.heroIcon.bind(this)))}heroIcon(t){return(0,r.qy)(W||(W=(0,o.A)(['\n      <wui-icon-box\n        size="xl"\n        iconSize="xxl"\n        iconColor="fg-100"\n        backgroundColor="fg-100"\n        icon=',"\n        data-state=",'\n        isOpaque\n        class="hero-row-icon"\n      >\n      </wui-icon-box>\n    '])),t,this.loading?"loading":"default")}paragraph(){return this.loading?(0,r.qy)(D||(D=(0,o.A)(['\n        <wui-text variant="paragraph-400" color="fg-200" align="center"\n          >We are verifying your account with email\n          <wui-text variant="paragraph-600" color="accent-100">','</wui-text> and address\n          <wui-text variant="paragraph-600" color="fg-100">\n            '," </wui-text\n          >, please wait a moment.</wui-text\n        >\n      "])),this.email,s.Zv.getTruncateString({string:this.address,charsEnd:4,charsStart:4,truncate:"middle"})):this.isRequired?(0,r.qy)(j||(j=(0,o.A)(['\n        <wui-text variant="paragraph-600" color="fg-100" align="center">\n          '," requires your email for authentication.\n        </wui-text>\n      "])),this.appName):(0,r.qy)(L||(L=(0,o.A)(['\n      <wui-flex flexDirection="column" gap="xs" alignItems="center">\n        <wui-text variant="paragraph-600" color="fg-100" align="center" size>\n          ',' would like to collect your email.\n        </wui-text>\n\n        <wui-text variant="small-400" color="fg-200" align="center">\n          Don\'t worry, it\'s optional&mdash;you can skip this step.\n        </wui-text>\n      </wui-flex>\n    '])),this.appName)}emailInput(){if(this.loading)return null;const t=t=>{this.email=t.detail};return(0,r.qy)(U||(U=(0,o.A)(['\n      <wui-flex flexDirection="column">\n        <wui-email-input\n          .value=',"\n          .disabled=","\n          @inputChange=","\n          @keydown=","\n        ></wui-email-input>\n\n        <w3m-email-suffixes-widget\n          .email=","\n          @change=","\n        ></w3m-email-suffixes-widget>\n      </wui-flex>\n    "])),this.email,this.loading,t,(t=>{"Enter"===t.key&&this.onSubmit()}),this.email,t)}recentEmailsWidget(){if(0===this.recentEmails.length||this.loading)return null;return(0,r.qy)(K||(K=(0,o.A)(["\n      <w3m-recent-emails-widget\n        .emails=","\n        @select=","\n      ></w3m-recent-emails-widget>\n    "])),this.recentEmails,(t=>{this.email=t.detail,this.onSubmit()}))}footerActions(){return(0,r.qy)(M||(M=(0,o.A)(['\n      <wui-flex flexDirection="row" fullWidth gap="s">\n        ','\n\n        <wui-button\n          size="lg"\n          variant="main"\n          type="submit"\n          fullWidth\n          .disabled=',"\n          .loading=","\n          @click=","\n        >\n          Continue\n        </wui-button>\n      </wui-flex>\n    "])),this.isRequired?null:(0,r.qy)(z||(z=(0,o.A)(['<wui-button\n              size="lg"\n              variant="neutral"\n              fullWidth\n              .disabled=',"\n              @click=","\n              >Skip this step</wui-button\n            >"])),this.loading,this.onSkip.bind(this)),!this.email||!this.isValidEmail(this.email),this.loading,this.onSubmit.bind(this))}async onSubmit(){if(!(this.siwx instanceof E.u))return void A.P.showError("ReownAuthentication is not initialized. Please contact support.");const t=k.W.getActiveCaipAddress();if(!t)throw new Error("Account is not connected.");if(this.isValidEmail(this.email))try{this.loading=!0;const e=await this.siwx.requestEmailOtp({email:this.email,account:t});this.pushRecentEmail(this.email),null===e.uuid?x.I.replace("SIWXSignMessage"):x.I.replace("DataCaptureOtpConfirm",{email:this.email})}catch(e){A.P.showError("Failed to send email OTP"),this.loading=!1}else A.P.showError("Please provide a valid email.")}onSkip(){x.I.replace("SIWXSignMessage")}getRecentEmails(){const t=R.Ud.getItem(R.Ws.RECENT_EMAILS);return(t?t.split(","):[]).filter(this.isValidEmail.bind(this)).slice(0,3)}pushRecentEmail(t){const e=this.getRecentEmails(),n=Array.from(new Set([t,...e])).slice(0,3);R.Ud.setItem(R.Ws.RECENT_EMAILS,n.join(","))}isValidEmail(t){return/^\S+@\S+\.\S+$/u.test(t)}};H.styles=[C],F([(0,a.wk)()],H.prototype,"email",void 0),F([(0,a.wk)()],H.prototype,"address",void 0),F([(0,a.wk)()],H.prototype,"loading",void 0),F([(0,a.wk)()],H.prototype,"appName",void 0),F([(0,a.wk)()],H.prototype,"siwx",void 0),F([(0,a.wk)()],H.prototype,"isRequired",void 0),F([(0,a.wk)()],H.prototype,"recentEmails",void 0),H=F([(0,s.EM)("w3m-data-capture-view")],H)},41722:(t,e,n)=>{n.d(e,{H:()=>W});var i,o=n(57528),r=n(37022),a=n(56370),s=n(61139),l=n(25015),c=n(24657),u=n(7258),d=n(89268),h=(n(84107),n(43901),n(94582),n(52574),n(39446)),p=n(69929),m=n(37845);const g=(0,n(89406).AH)(i||(i=(0,o.A)(["\n  :host {\n    position: relative;\n    display: inline-block;\n  }\n\n  input {\n    width: 48px;\n    height: 48px;\n    background: ",";\n    border-radius: ",";\n    border: 1px solid ",";\n    font-family: ",";\n    font-size: ",";\n    line-height: 18px;\n    letter-spacing: -0.16px;\n    text-align: center;\n    color: ",";\n    caret-color: ",";\n    transition:\n      background-color ","\n        ",",\n      border-color ","\n        ",",\n      box-shadow ","\n        ",";\n    will-change: background-color, border-color, box-shadow;\n    box-sizing: border-box;\n    -webkit-appearance: none;\n    -moz-appearance: textfield;\n    padding: ",";\n  }\n\n  input::-webkit-outer-spin-button,\n  input::-webkit-inner-spin-button {\n    -webkit-appearance: none;\n    margin: 0;\n  }\n\n  input[type='number'] {\n    -moz-appearance: textfield;\n  }\n\n  input:disabled {\n    cursor: not-allowed;\n    opacity: 0.5;\n  }\n\n  input:focus-visible:enabled {\n    background-color: transparent;\n    border: 1px solid ",";\n    box-shadow: 0px 0px 0px 4px ",";\n  }\n"])),(t=>{let{tokens:e}=t;return e.theme.foregroundPrimary}),(t=>{let{borderRadius:e}=t;return e[4]}),(t=>{let{tokens:e}=t;return e.theme.borderPrimary}),(t=>{let{fontFamily:e}=t;return e.regular}),(t=>{let{textSize:e}=t;return e.large}),(t=>{let{tokens:e}=t;return e.theme.textPrimary}),(t=>{let{tokens:e}=t;return e.core.textAccentPrimary}),(t=>{let{durations:e}=t;return e.lg}),(t=>{let{easings:e}=t;return e["ease-out-power-2"]}),(t=>{let{durations:e}=t;return e.lg}),(t=>{let{easings:e}=t;return e["ease-out-power-2"]}),(t=>{let{durations:e}=t;return e.lg}),(t=>{let{easings:e}=t;return e["ease-out-power-2"]}),(t=>{let{spacing:e}=t;return e[4]}),(t=>{let{tokens:e}=t;return e.theme.borderSecondary}),(t=>{let{tokens:e}=t;return e.core.foregroundAccent040}));var w,f=function(t,e,n,i){var o,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,n,a):o(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};let v=class extends r.WF{constructor(){super(...arguments),this.disabled=!1,this.value=""}render(){return(0,r.qy)(w||(w=(0,o.A)(['<input\n      type="number"\n      maxlength="1"\n      inputmode="numeric"\n      autofocus\n      ?disabled=',"\n      value=","\n    /> "])),this.disabled,this.value)}};var y;v.styles=[h.W5,h.fD,g],f([(0,a.MZ)({type:Boolean})],v.prototype,"disabled",void 0),f([(0,a.MZ)({type:String})],v.prototype,"value",void 0),v=f([(0,m.E)("wui-input-numeric")],v);const b=(0,r.AH)(y||(y=(0,o.A)(["\n  :host {\n    position: relative;\n    display: block;\n  }\n"])));var x,k,A=function(t,e,n,i){var o,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,n,a):o(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};let E=class extends r.WF{constructor(){super(...arguments),this.length=6,this.otp="",this.values=Array.from({length:this.length}).map((()=>"")),this.numerics=[],this.shouldInputBeEnabled=t=>this.values.slice(0,t).every((t=>""!==t)),this.handleKeyDown=(t,e)=>{const n=t.target,i=this.getInputElement(n);if(!i)return;["ArrowLeft","ArrowRight","Shift","Delete"].includes(t.key)&&t.preventDefault();const o=i.selectionStart;switch(t.key){case"ArrowLeft":o&&i.setSelectionRange(o+1,o+1),this.focusInputField("prev",e);break;case"ArrowRight":case"Shift":this.focusInputField("next",e);break;case"Delete":case"Backspace":""===i.value?this.focusInputField("prev",e):this.updateInput(i,e,"")}},this.focusInputField=(t,e)=>{if("next"===t){const t=e+1;if(!this.shouldInputBeEnabled(t))return;const n=this.numerics[t<this.length?t:e],i=n?this.getInputElement(n):void 0;i&&(i.disabled=!1,i.focus())}if("prev"===t){const t=e-1,n=this.numerics[t>-1?t:e],i=n?this.getInputElement(n):void 0;i&&i.focus()}}}firstUpdated(){var t,e;this.otp&&(this.values=this.otp.split(""));const n=null===(t=this.shadowRoot)||void 0===t?void 0:t.querySelectorAll("wui-input-numeric");n&&(this.numerics=Array.from(n)),null===(e=this.numerics[0])||void 0===e||e.focus()}render(){return(0,r.qy)(x||(x=(0,o.A)(['\n      <wui-flex gap="1" data-testid="wui-otp-input">\n        ',"\n      </wui-flex>\n    "])),Array.from({length:this.length}).map(((t,e)=>(0,r.qy)(k||(k=(0,o.A)(["\n            <wui-input-numeric\n              @input=","\n              @click=","\n              @keydown=","\n              .disabled=","\n              .value=","\n            >\n            </wui-input-numeric>\n          "])),(t=>this.handleInput(t,e)),(t=>this.selectInput(t)),(t=>this.handleKeyDown(t,e)),!this.shouldInputBeEnabled(e),this.values[e]||""))))}updateInput(t,e,n){const i=this.numerics[e],o=t||(i?this.getInputElement(i):void 0);o&&(o.value=n,this.values=this.values.map(((t,i)=>i===e?n:t)))}selectInput(t){const e=t.target;if(e){const t=this.getInputElement(e);null===t||void 0===t||t.select()}}handleInput(t,e){const n=t.target,i=this.getInputElement(n);if(i){const n=i.value;if("insertFromPaste"===t.inputType)this.handlePaste(i,n,e);else{p.Z.isNumber(n)&&t.data?(this.updateInput(i,e,t.data),this.focusInputField("next",e)):this.updateInput(i,e,"")}}this.dispatchInputChangeEvent()}handlePaste(t,e,n){const i=e[0];if(i&&p.Z.isNumber(i)){this.updateInput(t,n,i);const o=e.substring(1);if(n+1<this.length&&o.length){const t=this.numerics[n+1],e=t?this.getInputElement(t):void 0;e&&this.handlePaste(e,o,n+1)}else this.focusInputField("next",n)}else this.updateInput(t,n,"")}getInputElement(t){var e;return null!==(e=t.shadowRoot)&&void 0!==e&&e.querySelector("input")?t.shadowRoot.querySelector("input"):null}dispatchInputChangeEvent(){const t=this.values.join("");this.dispatchEvent(new CustomEvent("inputChange",{detail:t,bubbles:!0,composed:!0}))}};E.styles=[h.W5,b],A([(0,a.MZ)({type:Number})],E.prototype,"length",void 0),A([(0,a.MZ)({type:String})],E.prototype,"otp",void 0),A([(0,a.wk)()],E.prototype,"values",void 0),E=A([(0,m.E)("wui-otp")],E);n(84875);var I,S=n(22538);const T=(0,r.AH)(I||(I=(0,o.A)(["\n  wui-loading-spinner {\n    margin: 9px auto;\n  }\n\n  .email-display,\n  .email-display wui-text {\n    max-width: 100%;\n  }\n"])));var O,R,C,N,q,P=function(t,e,n,i){var o,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,n,a):o(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};let W=q=class extends r.WF{firstUpdated(){this.startOTPTimeout()}disconnectedCallback(){clearTimeout(this.OTPTimeout)}constructor(){var t;super(),this.loading=!1,this.timeoutTimeLeft=S.Q.getTimeToNextEmailLogin(),this.error="",this.otp="",this.email=null===(t=s.I.state.data)||void 0===t?void 0:t.email,this.authConnector=l.a.getAuthConnector()}render(){if(!this.email)throw new Error("w3m-email-otp-widget: No email provided");const t=Boolean(this.timeoutTimeLeft),e=this.getFooterLabels(t);return(0,r.qy)(O||(O=(0,o.A)(['\n      <wui-flex\n        flexDirection="column"\n        alignItems="center"\n        .padding=','\n        gap="4"\n      >\n        <wui-flex\n          class="email-display"\n          flexDirection="column"\n          alignItems="center"\n          .padding=','\n        >\n          <wui-text variant="md-regular" color="primary" align="center">\n            Enter the code we sent to\n          </wui-text>\n          <wui-text variant="md-medium" color="primary" lineClamp="1" align="center">\n            ','\n          </wui-text>\n        </wui-flex>\n\n        <wui-text variant="sm-regular" color="secondary">The code expires in 20 minutes</wui-text>\n\n        ','\n\n        <wui-flex alignItems="center" gap="2">\n          <wui-text variant="sm-regular" color="secondary">',"</wui-text>\n          <wui-link @click="," .disabled=",">\n            ","\n          </wui-link>\n        </wui-flex>\n      </wui-flex>\n    "])),["4","0","4","0"],["0","5","0","5"],this.email,this.loading?(0,r.qy)(R||(R=(0,o.A)(['<wui-loading-spinner size="xl" color="accent-primary"></wui-loading-spinner>']))):(0,r.qy)(C||(C=(0,o.A)([' <wui-flex flexDirection="column" alignItems="center" gap="2">\n              <wui-otp\n                dissabled\n                length="6"\n                @inputChange=',"\n                .otp=","\n              ></wui-otp>\n              ","\n            </wui-flex>"])),this.onOtpInputChange.bind(this),this.otp,this.error?(0,r.qy)(N||(N=(0,o.A)(['\n                    <wui-text variant="sm-regular" align="center" color="error">\n                      ',". Try Again\n                    </wui-text>\n                  "])),this.error):null),e.title,this.onResendCode.bind(this),t,e.action)}startOTPTimeout(){this.timeoutTimeLeft=S.Q.getTimeToNextEmailLogin(),this.OTPTimeout=setInterval((()=>{this.timeoutTimeLeft>0?this.timeoutTimeLeft=S.Q.getTimeToNextEmailLogin():clearInterval(this.OTPTimeout)}),1e3)}async onOtpInputChange(t){try{var e;if(!this.loading)if(this.otp=t.detail,this.shouldSubmitOnOtpChange())this.loading=!0,await(null===(e=this.onOtpSubmit)||void 0===e?void 0:e.call(this,this.otp))}catch(n){this.error=c.w.parseError(n),this.loading=!1}}async onResendCode(){try{if(this.onOtpResend){if(!this.loading&&!this.timeoutTimeLeft){this.error="",this.otp="";if(!l.a.getAuthConnector()||!this.email)throw new Error("w3m-email-otp-widget: Unable to resend email");this.loading=!0,await this.onOtpResend(this.email),this.startOTPTimeout(),u.P.showSuccess("Code email resent")}}else this.onStartOver&&this.onStartOver()}catch(t){u.P.showError(t)}finally{this.loading=!1}}getFooterLabels(t){return this.onStartOver?{title:"Something wrong?",action:"Try again ".concat(t?"in ".concat(this.timeoutTimeLeft,"s"):"")}:{title:"Didn't receive it?",action:"Resend ".concat(t?"in ".concat(this.timeoutTimeLeft,"s"):"Code")}}shouldSubmitOnOtpChange(){return this.authConnector&&this.otp.length===q.OTP_LENGTH}};W.OTP_LENGTH=6,W.styles=T,P([(0,a.wk)()],W.prototype,"loading",void 0),P([(0,a.wk)()],W.prototype,"timeoutTimeLeft",void 0),P([(0,a.wk)()],W.prototype,"error",void 0),W=q=P([(0,d.EM)("w3m-email-otp-widget")],W)}}]);
//# sourceMappingURL=3151.f8d036a7.chunk.js.map